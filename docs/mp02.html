<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lincon Chopra">

<title>Mini-Project #02: Making Backyards Affordable for All – STA 9750 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b3aed8deb8408878d0e4e165d993d59e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-4913dc41de1e81582468a3e935c6e3dc.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-b3aed8deb8408878d0e4e165d993d59e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/viz-1.8.2/viz.js"></script>

<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">

<script src="site_libs/grViz-binding-1.0.11/grViz.js"></script>

<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="site_libs/datatables-binding-0.34.0/datatables.js"></script>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">

<script src="site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>

<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">

<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>



</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750 Submission Material</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#task-1-data-acquisition" id="toc-task-1-data-acquisition" class="nav-link" data-scroll-target="#task-1-data-acquisition">Task 1: Data acquisition</a>
  <ul class="collapse">
  <li><a href="#relationship-diagram" id="toc-relationship-diagram" class="nav-link" data-scroll-target="#relationship-diagram">Relationship Diagram</a></li>
  </ul></li>
  <li><a href="#task-2-multi-table-questions" id="toc-task-2-multi-table-questions" class="nav-link" data-scroll-target="#task-2-multi-table-questions">Task 2: Multi-Table Questions</a>
  <ul class="collapse">
  <li><a href="#question-1-which-cbsa-by-name-permitted-the-largest-number-of-new-housing-units-in-the-decade-from-2010-to-2019-inclusive" id="toc-question-1-which-cbsa-by-name-permitted-the-largest-number-of-new-housing-units-in-the-decade-from-2010-to-2019-inclusive" class="nav-link" data-scroll-target="#question-1-which-cbsa-by-name-permitted-the-largest-number-of-new-housing-units-in-the-decade-from-2010-to-2019-inclusive">Question 1: Which CBSA (by name) permitted the largest number of new housing units in the decade from 2010 to 2019 (inclusive)?</a></li>
  <li><a href="#question-2-in-what-year-did-albuquerque-nm-cbsa-number-10740-permit-the-most-new-housing-units" id="toc-question-2-in-what-year-did-albuquerque-nm-cbsa-number-10740-permit-the-most-new-housing-units" class="nav-link" data-scroll-target="#question-2-in-what-year-did-albuquerque-nm-cbsa-number-10740-permit-the-most-new-housing-units">Question 2: In what year did Albuquerque, NM (CBSA Number 10740) permit the most new housing units?</a></li>
  <li><a href="#question-3-which-state-not-cbsa-had-the-highest-average-individual-income-in-2015" id="toc-question-3-which-state-not-cbsa-had-the-highest-average-individual-income-in-2015" class="nav-link" data-scroll-target="#question-3-which-state-not-cbsa-had-the-highest-average-individual-income-in-2015">Question 3: Which state (not CBSA) had the highest average individual income in 2015?</a></li>
  <li><a href="#question-4-data-scientists-and-business-analysts-are-recorded-under-naics-code-5182.-what-is-the-last-year-in-which-the-nyc-cbsa-had-the-most-data-scientists-in-the-country-in-recent-the-san-francisco-cbsa-has-had-the-most-data-scientists." id="toc-question-4-data-scientists-and-business-analysts-are-recorded-under-naics-code-5182.-what-is-the-last-year-in-which-the-nyc-cbsa-had-the-most-data-scientists-in-the-country-in-recent-the-san-francisco-cbsa-has-had-the-most-data-scientists." class="nav-link" data-scroll-target="#question-4-data-scientists-and-business-analysts-are-recorded-under-naics-code-5182.-what-is-the-last-year-in-which-the-nyc-cbsa-had-the-most-data-scientists-in-the-country-in-recent-the-san-francisco-cbsa-has-had-the-most-data-scientists.">Question 4: Data scientists and business analysts are recorded under NAICS code 5182. What is the last year in which the NYC CBSA had the most data scientists in the country? In recent, the San Francisco CBSA has had the most data scientists.</a></li>
  <li><a href="#question-5-what-fraction-of-total-wages-in-the-nyc-cbsa-was-earned-by-people-employed-in-the-finance-and-insurance-industries-naics-code-52-in-what-year-did-this-fraction-peak" id="toc-question-5-what-fraction-of-total-wages-in-the-nyc-cbsa-was-earned-by-people-employed-in-the-finance-and-insurance-industries-naics-code-52-in-what-year-did-this-fraction-peak" class="nav-link" data-scroll-target="#question-5-what-fraction-of-total-wages-in-the-nyc-cbsa-was-earned-by-people-employed-in-the-finance-and-insurance-industries-naics-code-52-in-what-year-did-this-fraction-peak">Question 5: What fraction of total wages in the NYC CBSA was earned by people employed in the finance and insurance industries (NAICS code 52)? In what year did this fraction peak?</a></li>
  </ul></li>
  <li><a href="#task-3-initial-visualizations" id="toc-task-3-initial-visualizations" class="nav-link" data-scroll-target="#task-3-initial-visualizations">Task 3: Initial Visualizations</a>
  <ul class="collapse">
  <li><a href="#relationship-1-the-relationship-between-monthly-rent-and-average-household-income-per-cbsa-in-2009." id="toc-relationship-1-the-relationship-between-monthly-rent-and-average-household-income-per-cbsa-in-2009." class="nav-link" data-scroll-target="#relationship-1-the-relationship-between-monthly-rent-and-average-household-income-per-cbsa-in-2009.">Relationship 1: The relationship between monthly rent and average household income per CBSA in 2009.</a></li>
  <li><a href="#relationship-2-the-relationship-between-total-employment-and-total-employment-in-the-health-care-and-social-services-sector-naics-62-across-different-cbsas.-design-your-visualization-so-that-it-is-possible-to-see-the-evolution-of-this-relationship-over-time." id="toc-relationship-2-the-relationship-between-total-employment-and-total-employment-in-the-health-care-and-social-services-sector-naics-62-across-different-cbsas.-design-your-visualization-so-that-it-is-possible-to-see-the-evolution-of-this-relationship-over-time." class="nav-link" data-scroll-target="#relationship-2-the-relationship-between-total-employment-and-total-employment-in-the-health-care-and-social-services-sector-naics-62-across-different-cbsas.-design-your-visualization-so-that-it-is-possible-to-see-the-evolution-of-this-relationship-over-time.">Relationship 2: The relationship between total employment and total employment in the health care and social services sector (NAICS 62) across different CBSAs. Design your visualization so that it is possible to see the evolution of this relationship over time.</a></li>
  <li><a href="#relationship-3-the-evolution-of-average-household-size-over-time." id="toc-relationship-3-the-evolution-of-average-household-size-over-time." class="nav-link" data-scroll-target="#relationship-3-the-evolution-of-average-household-size-over-time.">Relationship 3: The evolution of average household size over time.</a></li>
  </ul></li>
  <li><a href="#task-4-rent-burden" id="toc-task-4-rent-burden" class="nav-link" data-scroll-target="#task-4-rent-burden">Task 4: Rent Burden</a></li>
  <li><a href="#task-5-housing-growth" id="toc-task-5-housing-growth" class="nav-link" data-scroll-target="#task-5-housing-growth">Task 5: Housing Growth</a></li>
  <li><a href="#task-6-visualization" id="toc-task-6-visualization" class="nav-link" data-scroll-target="#task-6-visualization">Task 6: Visualization</a></li>
  <li><a href="#task-7-policy-brief-its-our-homes-and-we-need-it-now" id="toc-task-7-policy-brief-its-our-homes-and-we-need-it-now" class="nav-link" data-scroll-target="#task-7-policy-brief-its-our-homes-and-we-need-it-now">Task 7: Policy Brief: <strong>It’s our homes and we need it now!</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mini-Project #02: Making Backyards Affordable for All</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lincon Chopra </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode css code-with-copy"><code class="sourceCode css"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.indent-block-tab</span> {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">text-indent</span><span class="ch">:</span> <span class="dv">2</span><span class="dt">em</span><span class="op">;</span>    </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<style type="text/css">
.indent-block-tab {
text-indent: 2em;    
}
</style>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<div class="indent-block-tab">
<p>Housing costs are one of the biggest pressures facing U.S. cities. In this mini-project I’m exploring <strong>where housing is most (and least) affordable</strong> and which metro areas are actually building enough new homes to keep up with demand.</p>
</div>
</section>
<section id="task-1-data-acquisition" class="level2">
<h2 class="anchored" data-anchor-id="task-1-data-acquisition">Task 1: Data acquisition</h2>
<div class="indent-block-tab">
<p>Here we will incorporate the instructor provided code into our report. This will help with the data acquisition.</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>))){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(<span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>), <span class="at">showWarnings=</span><span class="cn">FALSE</span>, <span class="at">recursive=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>library <span class="ot">&lt;-</span> <span class="cf">function</span>(pkg){</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Mask base::library() to automatically install packages if needed</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Masking is important here so downlit picks up packages and links</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="do">## to documentation</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    pkg <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">substitute</span>(pkg))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"https://cloud.r-project.org"</span>))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(pkg, <span class="at">character.only=</span><span class="cn">TRUE</span>, <span class="at">quietly=</span><span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(pkg)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">require</span>(pkg, <span class="at">character.only=</span><span class="cn">TRUE</span>, <span class="at">quietly=</span><span class="cn">TRUE</span>))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidycensus)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>get_acs_all_years <span class="ot">&lt;-</span> <span class="cf">function</span>(variable, <span class="at">geography=</span><span class="st">"cbsa"</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                              <span class="at">start_year=</span><span class="dv">2009</span>, <span class="at">end_year=</span><span class="dv">2023</span>){</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"{variable}_{geography}_{start_year}_{end_year}.csv"</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>, fname)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname)){</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        YEARS <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_year, end_year)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        YEARS <span class="ot">&lt;-</span> YEARS[YEARS <span class="sc">!=</span> <span class="dv">2020</span>] <span class="co"># Drop 2020 - No survey (covid)</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>        ALL_DATA <span class="ot">&lt;-</span> <span class="fu">map</span>(YEARS, <span class="cf">function</span>(yy){</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>            tidycensus<span class="sc">::</span><span class="fu">get_acs</span>(geography, variable, <span class="at">year=</span>yy, <span class="at">survey=</span><span class="st">"acs1"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">year=</span>yy) <span class="sc">|&gt;</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(<span class="sc">-</span>moe, <span class="sc">-</span>variable) <span class="sc">|&gt;</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rename</span>(<span class="sc">!!</span><span class="at">variable :=</span> estimate)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        }) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write_csv</span>(ALL_DATA, fname)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_csv</span>(fname, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Household income (12 month)</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>INCOME <span class="ot">&lt;-</span> <span class="fu">get_acs_all_years</span>(<span class="st">"B19013_001"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">household_income =</span> B19013_001)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Monthly rent</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>RENT <span class="ot">&lt;-</span> <span class="fu">get_acs_all_years</span>(<span class="st">"B25064_001"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">monthly_rent =</span> B25064_001)</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Total population</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>POPULATION <span class="ot">&lt;-</span> <span class="fu">get_acs_all_years</span>(<span class="st">"B01003_001"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">population =</span> B01003_001)</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of households</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>HOUSEHOLDS <span class="ot">&lt;-</span> <span class="fu">get_acs_all_years</span>(<span class="st">"B11001_001"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">households =</span> B11001_001)</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>get_building_permits <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">start_year =</span> <span class="dv">2009</span>, <span class="at">end_year =</span> <span class="dv">2023</span>){</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"housing_units_{start_year}_{end_year}.csv"</span>)</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>, fname)</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname)){</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>        HISTORICAL_YEARS <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_year, <span class="dv">2018</span>)</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>        HISTORICAL_DATA <span class="ot">&lt;-</span> <span class="fu">map</span>(HISTORICAL_YEARS, <span class="cf">function</span>(yy){</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>            historical_url <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"https://www.census.gov/construction/bps/txt/tb3u{yy}.txt"</span>)</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>            LINES <span class="ot">&lt;-</span> <span class="fu">readLines</span>(historical_url)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>)]</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>            CBSA_LINES <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(LINES, <span class="st">"^[[:digit:]]"</span>)</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>            CBSA <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">str_sub</span>(LINES[CBSA_LINES], <span class="dv">5</span>, <span class="dv">10</span>))</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>            PERMIT_LINES <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(<span class="fu">str_sub</span>(LINES, <span class="dv">48</span>, <span class="dv">53</span>), <span class="st">"[[:digit:]]"</span>)</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>            PERMITS <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">str_sub</span>(LINES[PERMIT_LINES], <span class="dv">48</span>, <span class="dv">53</span>))</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data_frame</span>(<span class="at">CBSA =</span> CBSA,</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>                       <span class="at">new_housing_units_permitted =</span> PERMITS, </span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>                       <span class="at">year =</span> yy)</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>        }) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>        CURRENT_YEARS <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2019</span>, end_year)</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>        CURRENT_DATA <span class="ot">&lt;-</span> <span class="fu">map</span>(CURRENT_YEARS, <span class="cf">function</span>(yy){</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>            current_url <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"https://www.census.gov/construction/bps/xls/msaannual_{yy}99.xls"</span>)</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>            temp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>()</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>            <span class="fu">download.file</span>(current_url, <span class="at">destfile =</span> temp, <span class="at">mode=</span><span class="st">"wb"</span>)</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>            fallback <span class="ot">&lt;-</span> <span class="cf">function</span>(.f1, .f2){</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">function</span>(...){</span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">tryCatch</span>(<span class="fu">.f1</span>(...), </span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>                             <span class="at">error=</span><span class="cf">function</span>(e) <span class="fu">.f2</span>(...))</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>            reader <span class="ot">&lt;-</span> <span class="fu">fallback</span>(read_xlsx, read_xls)</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>            <span class="fu">reader</span>(temp, <span class="at">skip=</span><span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>                <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(CBSA, Total) <span class="sc">|&gt;</span></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">year =</span> yy) <span class="sc">|&gt;</span></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rename</span>(<span class="at">new_housing_units_permitted =</span> Total)</span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>        }) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>        ALL_DATA <span class="ot">&lt;-</span> <span class="fu">rbind</span>(HISTORICAL_DATA, CURRENT_DATA)</span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write_csv</span>(ALL_DATA, fname)</span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_csv</span>(fname, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>PERMITS <span class="ot">&lt;-</span> <span class="fu">get_building_permits</span>()</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>get_bls_industry_codes <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>, <span class="st">"bls_industry_codes.csv"</span>)</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname)){</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>        resp <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.bls.gov"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>            <span class="fu">req_url_path</span>(<span class="st">"cew"</span>, <span class="st">"classifications"</span>, <span class="st">"industry"</span>, <span class="st">"industry-titles.htm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>            <span class="fu">req_headers</span>(<span class="st">`</span><span class="at">User-Agent</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:143.0) Gecko/20100101 Firefox/143.0"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>            <span class="fu">req_error</span>(<span class="at">is_error =</span> \(resp) <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>            <span class="fu">req_perform</span>()</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>        <span class="fu">resp_check_status</span>(resp)</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>        naics_table <span class="ot">&lt;-</span> <span class="fu">resp_body_html</span>(resp) <span class="sc">|&gt;</span></span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>            <span class="fu">html_element</span>(<span class="st">"#naics_titles"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>            <span class="fu">html_table</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">title =</span> <span class="fu">str_trim</span>(<span class="fu">str_remove</span>(<span class="fu">str_remove</span>(<span class="st">`</span><span class="at">Industry Title</span><span class="st">`</span>, Code), <span class="st">"NAICS"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Industry Title</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">depth =</span> <span class="fu">if_else</span>(<span class="fu">nchar</span>(Code) <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="fu">nchar</span>(Code) <span class="sc">-</span> <span class="dv">1</span>, <span class="cn">NA</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(depth))</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>        naics_table <span class="ot">&lt;-</span> naics_table <span class="sc">|&gt;</span> </span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(depth <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level4_title=</span>title) <span class="sc">|&gt;</span> </span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">level1_code =</span> <span class="fu">str_sub</span>(Code, <span class="at">end=</span><span class="dv">2</span>), </span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>                   <span class="at">level2_code =</span> <span class="fu">str_sub</span>(Code, <span class="at">end=</span><span class="dv">3</span>), </span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>                   <span class="at">level3_code =</span> <span class="fu">str_sub</span>(Code, <span class="at">end=</span><span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>            <span class="fu">left_join</span>(naics_table, <span class="fu">join_by</span>(level1_code <span class="sc">==</span> Code)) <span class="sc">|&gt;</span></span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level1_title=</span>title) <span class="sc">|&gt;</span></span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>            <span class="fu">left_join</span>(naics_table, <span class="fu">join_by</span>(level2_code <span class="sc">==</span> Code)) <span class="sc">|&gt;</span></span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level2_title=</span>title) <span class="sc">|&gt;</span></span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>            <span class="fu">left_join</span>(naics_table, <span class="fu">join_by</span>(level3_code <span class="sc">==</span> Code)) <span class="sc">|&gt;</span></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level3_title=</span>title) <span class="sc">|&gt;</span></span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"depth"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level4_code =</span> Code) <span class="sc">|&gt;</span></span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(level1_title, level2_title, level3_title, level4_title, </span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>                   level1_code,  level2_code,  level3_code,  level4_code)</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write_csv</span>(naics_table, fname)</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_csv</span>(fname, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>INDUSTRY_CODES <span class="ot">&lt;-</span> <span class="fu">get_bls_industry_codes</span>()</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>get_bls_qcew_annual_averages <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">start_year=</span><span class="dv">2009</span>, <span class="at">end_year=</span><span class="dv">2023</span>){</span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"bls_qcew_{start_year}_{end_year}.csv.gz"</span>)</span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>, fname)</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>    YEARS <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_year, end_year)</span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a>    YEARS <span class="ot">&lt;-</span> YEARS[YEARS <span class="sc">!=</span> <span class="dv">2020</span>] <span class="co"># Drop Covid year to match ACS</span></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname)){</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>        ALL_DATA <span class="ot">&lt;-</span> <span class="fu">map</span>(YEARS, <span class="at">.progress=</span><span class="cn">TRUE</span>, <span class="fu">possibly</span>(<span class="cf">function</span>(yy){</span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>            fname_inner <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>, <span class="fu">glue</span>(<span class="st">"{yy}_qcew_annual_singlefile.zip"</span>))</span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname_inner)){</span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a>                <span class="fu">request</span>(<span class="st">"https://www.bls.gov"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">req_url_path</span>(<span class="st">"cew"</span>, <span class="st">"data"</span>, <span class="st">"files"</span>, yy, <span class="st">"csv"</span>,</span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">glue</span>(<span class="st">"{yy}_annual_singlefile.zip"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">req_headers</span>(<span class="st">`</span><span class="at">User-Agent</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:143.0) Gecko/20100101 Firefox/143.0"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">req_retry</span>(<span class="at">max_tries=</span><span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">req_perform</span>(fname_inner)</span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="fu">file.info</span>(fname_inner)<span class="sc">$</span>size <span class="sc">&lt;</span> <span class="fl">755e5</span>){</span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a>                <span class="fu">warning</span>(<span class="fu">sQuote</span>(fname_inner), <span class="st">"appears corrupted. Please delete and retry this step."</span>)</span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a>            <span class="fu">read_csv</span>(fname_inner, </span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a>                     <span class="at">show_col_types=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">YEAR =</span> yy) <span class="sc">|&gt;</span></span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(area_fips, </span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a>                       industry_code, </span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a>                       annual_avg_emplvl, </span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a>                       total_annual_wages, </span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a>                       YEAR) <span class="sc">|&gt;</span></span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="fu">nchar</span>(industry_code) <span class="sc">&lt;=</span> <span class="dv">5</span>, </span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">str_starts</span>(area_fips, <span class="st">"C"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="fu">str_detect</span>(industry_code, <span class="st">"-"</span>, <span class="at">negate=</span><span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">FIPS =</span> area_fips, </span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>                       <span class="at">INDUSTRY =</span> <span class="fu">as.integer</span>(industry_code), </span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a>                       <span class="at">EMPLOYMENT =</span> <span class="fu">as.integer</span>(annual_avg_emplvl), </span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a>                       <span class="at">TOTAL_WAGES =</span> total_annual_wages) <span class="sc">|&gt;</span></span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(<span class="sc">-</span>area_fips, </span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">-</span>industry_code, </span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">-</span>annual_avg_emplvl, </span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">-</span>total_annual_wages) <span class="sc">|&gt;</span></span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 10 is a special value: "all industries" , so omit</span></span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(INDUSTRY <span class="sc">!=</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">AVG_WAGE =</span> TOTAL_WAGES <span class="sc">/</span> EMPLOYMENT)</span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a>        })) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write_csv</span>(ALL_DATA, fname)</span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>    ALL_DATA <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(fname, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>    ALL_DATA_YEARS <span class="ot">&lt;-</span> <span class="fu">unique</span>(ALL_DATA<span class="sc">$</span>YEAR)</span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>    YEARS_DIFF <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(YEARS, ALL_DATA_YEARS)</span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(YEARS_DIFF) <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">"Download failed for the following years: "</span>, YEARS_DIFF, </span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>             <span class="st">". Please delete intermediate files and try again."</span>)</span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a>    ALL_DATA</span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a>WAGES <span class="ot">&lt;-</span> <span class="fu">get_bls_qcew_annual_averages</span>()</span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardized CBSA keys</span></span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a>as_cbsa5_census <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">cbsa5 =</span> <span class="fu">as.integer</span>(GEOID))</span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a><span class="co"># BLS "C1234"  -&gt; Census "12340"</span></span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a>as_cbsa5_bls <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">cbsa5 =</span> <span class="fu">as.integer</span>(<span class="fu">paste0</span>(readr<span class="sc">::</span><span class="fu">parse_number</span>(FIPS), <span class="st">"0"</span>)))</span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a><span class="co"># CBSA name lookup </span></span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a>cbsa_names <span class="ot">&lt;-</span> INCOME <span class="sc">%&gt;%</span></span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_cbsa5_census</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cbsa5, NAME) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="relationship-diagram" class="level3">
<h3 class="anchored" data-anchor-id="relationship-diagram">Relationship Diagram</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DiagrammeR)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>erd_dot <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="st">digraph ERD {</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">  graph [rankdir=LR, fontsize=10, labelloc=t, label='Mini-Project 02 — Data ERD'];</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">  node  [shape=plaintext, fontname='Helvetica'];</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">  edge  [fontsize=9, color='#555555'];</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="st">  INCOME [label=&lt;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;TABLE BORDER='1' CELLBORDER='1' CELLSPACING='0'&gt;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD BGCOLOR='lightgray' COLSPAN='2'&gt;&lt;B&gt;INCOME (ACS)&lt;/B&gt;&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;GEOID&lt;/TD&gt;&lt;TD&gt;string&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;year&lt;/TD&gt;&lt;TD&gt;int&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;household_income&lt;/TD&gt;&lt;TD&gt;number&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;NAME&lt;/TD&gt;&lt;TD&gt;string&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/TABLE&gt;</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="st">  &gt;];</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="st">  RENT [label=&lt;</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;TABLE BORDER='1' CELLBORDER='1' CELLSPACING='0'&gt;</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD BGCOLOR='lightgray' COLSPAN='2'&gt;&lt;B&gt;RENT (ACS)&lt;/B&gt;&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;GEOID&lt;/TD&gt;&lt;TD&gt;string&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;year&lt;/TD&gt;&lt;TD&gt;int&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;monthly_rent&lt;/TD&gt;&lt;TD&gt;number&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/TABLE&gt;</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="st">  &gt;];</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="st">  POP [label=&lt;</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;TABLE BORDER='1' CELLBORDER='1' CELLSPACING='0'&gt;</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD BGCOLOR='lightgray' COLSPAN='2'&gt;&lt;B&gt;POPULATION (ACS)&lt;/B&gt;&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;GEOID&lt;/TD&gt;&lt;TD&gt;string&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;year&lt;/TD&gt;&lt;TD&gt;int&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;population&lt;/TD&gt;&lt;TD&gt;int&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/TABLE&gt;</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="st">  &gt;];</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="st">  HH [label=&lt;</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;TABLE BORDER='1' CELLBORDER='1' CELLSPACING='0'&gt;</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD BGCOLOR='lightgray' COLSPAN='2'&gt;&lt;B&gt;HOUSEHOLDS (ACS)&lt;/B&gt;&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;GEOID&lt;/TD&gt;&lt;TD&gt;string&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;year&lt;/TD&gt;&lt;TD&gt;int&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;households&lt;/TD&gt;&lt;TD&gt;int&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/TABLE&gt;</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="st">  &gt;];</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="st">  PERMITS [label=&lt;</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;TABLE BORDER='1' CELLBORDER='1' CELLSPACING='0'&gt;</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD BGCOLOR='lightgray' COLSPAN='2'&gt;&lt;B&gt;PERMITS (Census BPS)&lt;/B&gt;&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;CBSA&lt;/TD&gt;&lt;TD&gt;int&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;year&lt;/TD&gt;&lt;TD&gt;int&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;new_housing_units_permitted&lt;/TD&gt;&lt;TD&gt;int&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/TABLE&gt;</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="st">  &gt;];</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="st">  WAGES [label=&lt;</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;TABLE BORDER='1' CELLBORDER='1' CELLSPACING='0'&gt;</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD BGCOLOR='lightgray' COLSPAN='2'&gt;&lt;B&gt;WAGES (BLS QCEW)&lt;/B&gt;&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;FIPS&lt;/TD&gt;&lt;TD&gt;string (e.g., C1234)&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;INDUSTRY&lt;/TD&gt;&lt;TD&gt;int (NAICS)&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;EMPLOYMENT&lt;/TD&gt;&lt;TD&gt;int&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;TOTAL_WAGES&lt;/TD&gt;&lt;TD&gt;number&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;AVG_WAGE&lt;/TD&gt;&lt;TD&gt;number&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;YEAR&lt;/TD&gt;&lt;TD&gt;int&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/TABLE&gt;</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="st">  &gt;];</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a><span class="st">  ICODES [label=&lt;</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;TABLE BORDER='1' CELLBORDER='1' CELLSPACING='0'&gt;</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD BGCOLOR='lightgray' COLSPAN='2'&gt;&lt;B&gt;INDUSTRY_CODES (NAICS titles)&lt;/B&gt;&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;level1_code..level4_code&lt;/TD&gt;&lt;TD&gt;string&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;level1_title..level4_title&lt;/TD&gt;&lt;TD&gt;string&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/TABLE&gt;</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a><span class="st">  &gt;];</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a><span class="st">  NAMES [label=&lt;</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;TABLE BORDER='1' CELLBORDER='1' CELLSPACING='0'&gt;</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD BGCOLOR='lightgray' COLSPAN='2'&gt;&lt;B&gt;CBSANAMES (lookup)&lt;/B&gt;&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;cbsa5&lt;/TD&gt;&lt;TD&gt;int&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;TR&gt;&lt;TD ALIGN='left'&gt;NAME&lt;/TD&gt;&lt;TD&gt;string&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/TABLE&gt;</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a><span class="st">  &gt;];</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a><span class="st">  // Intra-ACS joins (same grain: GEOID + year)</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a><span class="st">  INCOME -&gt; RENT [label='GEOID + year', color='#777777', arrowsize=0.7];</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a><span class="st">  INCOME -&gt; POP  [label='GEOID + year', color='#777777', arrowsize=0.7];</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a><span class="st">  INCOME -&gt; HH   [label='GEOID + year', color='#777777', arrowsize=0.7];</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="st">  // Map ACS to standardized CBSA key</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="st">  INCOME -&gt; NAMES [label='as.integer(GEOID) = cbsa5', arrowsize=0.7];</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a><span class="st">  // External sources mapped via cbsa5</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a><span class="st">  PERMITS -&gt; NAMES [label='CBSA = cbsa5', arrowsize=0.7];</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a><span class="st">  WAGES   -&gt; NAMES [label='FIPS C1234 → cbsa5 12340', arrowsize=0.7];</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a><span class="st">  // NAICS titles for BLS industries</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a><span class="st">  WAGES -&gt; ICODES [label='INDUSTRY (NAICS)', arrowsize=0.7];</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>DiagrammeR<span class="sc">::</span><span class="fu">grViz</span>(erd_dot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="grViz html-widget html-fill-item" id="htmlwidget-20abda77854bc871f0b3" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-20abda77854bc871f0b3">{"x":{"diagram":"\ndigraph ERD {\n  graph [rankdir=LR, fontsize=10, labelloc=t, label=\"Mini-Project 02 — Data ERD\"];\n  node  [shape=plaintext, fontname=\"Helvetica\"];\n  edge  [fontsize=9, color=\"#555555\"];\n\n  INCOME [label=<\n    <TABLE BORDER=\"1\" CELLBORDER=\"1\" CELLSPACING=\"0\">\n      <TR><TD BGCOLOR=\"lightgray\" COLSPAN=\"2\"><B>INCOME (ACS)<\/B><\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">GEOID<\/TD><TD>string<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">year<\/TD><TD>int<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">household_income<\/TD><TD>number<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">NAME<\/TD><TD>string<\/TD><\/TR>\n    <\/TABLE>\n  >];\n\n  RENT [label=<\n    <TABLE BORDER=\"1\" CELLBORDER=\"1\" CELLSPACING=\"0\">\n      <TR><TD BGCOLOR=\"lightgray\" COLSPAN=\"2\"><B>RENT (ACS)<\/B><\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">GEOID<\/TD><TD>string<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">year<\/TD><TD>int<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">monthly_rent<\/TD><TD>number<\/TD><\/TR>\n    <\/TABLE>\n  >];\n\n  POP [label=<\n    <TABLE BORDER=\"1\" CELLBORDER=\"1\" CELLSPACING=\"0\">\n      <TR><TD BGCOLOR=\"lightgray\" COLSPAN=\"2\"><B>POPULATION (ACS)<\/B><\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">GEOID<\/TD><TD>string<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">year<\/TD><TD>int<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">population<\/TD><TD>int<\/TD><\/TR>\n    <\/TABLE>\n  >];\n\n  HH [label=<\n    <TABLE BORDER=\"1\" CELLBORDER=\"1\" CELLSPACING=\"0\">\n      <TR><TD BGCOLOR=\"lightgray\" COLSPAN=\"2\"><B>HOUSEHOLDS (ACS)<\/B><\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">GEOID<\/TD><TD>string<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">year<\/TD><TD>int<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">households<\/TD><TD>int<\/TD><\/TR>\n    <\/TABLE>\n  >];\n\n  PERMITS [label=<\n    <TABLE BORDER=\"1\" CELLBORDER=\"1\" CELLSPACING=\"0\">\n      <TR><TD BGCOLOR=\"lightgray\" COLSPAN=\"2\"><B>PERMITS (Census BPS)<\/B><\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">CBSA<\/TD><TD>int<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">year<\/TD><TD>int<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">new_housing_units_permitted<\/TD><TD>int<\/TD><\/TR>\n    <\/TABLE>\n  >];\n\n  WAGES [label=<\n    <TABLE BORDER=\"1\" CELLBORDER=\"1\" CELLSPACING=\"0\">\n      <TR><TD BGCOLOR=\"lightgray\" COLSPAN=\"2\"><B>WAGES (BLS QCEW)<\/B><\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">FIPS<\/TD><TD>string (e.g., C1234)<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">INDUSTRY<\/TD><TD>int (NAICS)<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">EMPLOYMENT<\/TD><TD>int<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">TOTAL_WAGES<\/TD><TD>number<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">AVG_WAGE<\/TD><TD>number<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">YEAR<\/TD><TD>int<\/TD><\/TR>\n    <\/TABLE>\n  >];\n\n  ICODES [label=<\n    <TABLE BORDER=\"1\" CELLBORDER=\"1\" CELLSPACING=\"0\">\n      <TR><TD BGCOLOR=\"lightgray\" COLSPAN=\"2\"><B>INDUSTRY_CODES (NAICS titles)<\/B><\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">level1_code..level4_code<\/TD><TD>string<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">level1_title..level4_title<\/TD><TD>string<\/TD><\/TR>\n    <\/TABLE>\n  >];\n\n  NAMES [label=<\n    <TABLE BORDER=\"1\" CELLBORDER=\"1\" CELLSPACING=\"0\">\n      <TR><TD BGCOLOR=\"lightgray\" COLSPAN=\"2\"><B>CBSANAMES (lookup)<\/B><\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">cbsa5<\/TD><TD>int<\/TD><\/TR>\n      <TR><TD ALIGN=\"left\">NAME<\/TD><TD>string<\/TD><\/TR>\n    <\/TABLE>\n  >];\n\n  // Intra-ACS joins (same grain: GEOID + year)\n  INCOME -> RENT [label=\"GEOID + year\", color=\"#777777\", arrowsize=0.7];\n  INCOME -> POP  [label=\"GEOID + year\", color=\"#777777\", arrowsize=0.7];\n  INCOME -> HH   [label=\"GEOID + year\", color=\"#777777\", arrowsize=0.7];\n\n  // Map ACS to standardized CBSA key\n  INCOME -> NAMES [label=\"as.integer(GEOID) = cbsa5\", arrowsize=0.7];\n\n  // External sources mapped via cbsa5\n  PERMITS -> NAMES [label=\"CBSA = cbsa5\", arrowsize=0.7];\n  WAGES   -> NAMES [label=\"FIPS C1234 → cbsa5 12340\", arrowsize=0.7];\n\n  // NAICS titles for BLS industries\n  WAGES -> ICODES [label=\"INDUSTRY (NAICS)\", arrowsize=0.7];\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="task-2-multi-table-questions" class="level2">
<h2 class="anchored" data-anchor-id="task-2-multi-table-questions">Task 2: Multi-Table Questions</h2>
<div class="indent-block-tab">
<p>Here we will look at the data and answer some exploratory questions which will inspire some later thoughts.</p>
</div>
<section id="question-1-which-cbsa-by-name-permitted-the-largest-number-of-new-housing-units-in-the-decade-from-2010-to-2019-inclusive" class="level3">
<h3 class="anchored" data-anchor-id="question-1-which-cbsa-by-name-permitted-the-largest-number-of-new-housing-units-in-the-decade-from-2010-to-2019-inclusive">Question 1: Which CBSA (by name) permitted the largest number of new housing units in the decade from 2010 to 2019 (inclusive)?</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>permits_10s <span class="ot">&lt;-</span> PERMITS <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Standardize column names and CBSA id </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">cbsa5 =</span> <span class="fu">as.integer</span>(CBSA),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>            year,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">units =</span> new_housing_units_permitted) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Restrict to the 2010–2019 window </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2010</span>, year <span class="sc">&lt;=</span> <span class="dv">2019</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>q1 <span class="ot">&lt;-</span> permits_10s <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add up all annual permits within the decade for each CBSA</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cbsa5) <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">permits_total =</span> <span class="fu">sum</span>(units, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Attach metro names </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cbsa_names, <span class="at">by =</span> <span class="st">"cbsa5"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rank from most → least permits </span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(permits_total)) <span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="indent-block-tab">
<p>From 2010–2019, the most new housing units were permitted in <strong>Houston-Sugar Land-Baytown, TX Metro Area</strong> with <strong>482,075</strong> permits.</p>
</div>
</section>
<section id="question-2-in-what-year-did-albuquerque-nm-cbsa-number-10740-permit-the-most-new-housing-units" class="level3">
<h3 class="anchored" data-anchor-id="question-2-in-what-year-did-albuquerque-nm-cbsa-number-10740-permit-the-most-new-housing-units">Question 2: In what year did Albuquerque, NM (CBSA Number 10740) permit the most new housing units?</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>q2 <span class="ot">&lt;-</span> PERMITS <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cbsa5 =</span> <span class="fu">as.integer</span>(CBSA),                    </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    year,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> new_housing_units_permitted</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cbsa5 <span class="sc">==</span> <span class="dv">10740</span>) <span class="sc">%&gt;%</span>                     <span class="co"># Albuquerque CBSA</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(units)) <span class="sc">%&gt;%</span>                       <span class="co"># rank years by units</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)                                       <span class="co"># take the max year</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="indent-block-tab">
<p>In the year <strong>2021</strong> Albuquerque, NM permitted the most new housing units at <strong>4,021</strong>.</p>
</div>
</section>
<section id="question-3-which-state-not-cbsa-had-the-highest-average-individual-income-in-2015" class="level3">
<h3 class="anchored" data-anchor-id="question-3-which-state-not-cbsa-had-the-highest-average-individual-income-in-2015">Question 3: Which state (not CBSA) had the highest average individual income in 2015?</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull 2015 median household income from ACS </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>inc15 <span class="ot">&lt;-</span> INCOME <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_cbsa5_census</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    cbsa5,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    NAME,                         <span class="co"># carries ", ST" for state extraction</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">hh_inc =</span> household_income              </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull 2015 households </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>hh15 <span class="ot">&lt;-</span> HOUSEHOLDS <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_cbsa5_census</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    cbsa5,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    households                              </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull 2015 population </span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>pop15 <span class="ot">&lt;-</span> POPULATION <span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_cbsa5_census</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    cbsa5,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    population                              </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Join at CBSA level and compute per-state average individual income</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>q3 <span class="ot">&lt;-</span> inc15 <span class="sc">%&gt;%</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(hh15,  <span class="at">by =</span> <span class="st">"cbsa5"</span>) <span class="sc">%&gt;%</span>      <span class="co"># need BOTH income &amp; households</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(pop15, <span class="at">by =</span> <span class="st">"cbsa5"</span>) <span class="sc">%&gt;%</span>      <span class="co"># need population to compute per-person</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_income =</span> hh_inc <span class="sc">*</span> households,    </span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_abbr =</span> stringr<span class="sc">::</span><span class="fu">str_match</span>(NAME, <span class="st">",</span><span class="sc">\\</span><span class="st">s*([A-Z]{2})"</span>)[, <span class="dv">2</span>]</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state_abbr) <span class="sc">%&gt;%</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_total_income =</span> <span class="fu">sum</span>(total_income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_population   =</span> <span class="fu">sum</span>(population,   <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">avg_indiv_income =</span> state_total_income <span class="sc">/</span> state_population) <span class="sc">%&gt;%</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_indiv_income)) <span class="sc">%&gt;%</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)                                  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="indent-block-tab">
<p>In 2015, the state with the highest average individual income was <strong>DC</strong>.</p>
</div>
</section>
<section id="question-4-data-scientists-and-business-analysts-are-recorded-under-naics-code-5182.-what-is-the-last-year-in-which-the-nyc-cbsa-had-the-most-data-scientists-in-the-country-in-recent-the-san-francisco-cbsa-has-had-the-most-data-scientists." class="level3">
<h3 class="anchored" data-anchor-id="question-4-data-scientists-and-business-analysts-are-recorded-under-naics-code-5182.-what-is-the-last-year-in-which-the-nyc-cbsa-had-the-most-data-scientists-in-the-country-in-recent-the-san-francisco-cbsa-has-had-the-most-data-scientists.">Question 4: Data scientists and business analysts are recorded under NAICS code 5182. What is the last year in which the NYC CBSA had the most data scientists in the country? In recent, the San Francisco CBSA has had the most data scientists.</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep every CBSA that ties for the maximum per year</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>w5182_winners <span class="ot">&lt;-</span> WAGES <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_cbsa5_bls</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(INDUSTRY <span class="sc">==</span> <span class="dv">5182</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EMPLOYMENT <span class="sc">==</span> <span class="fu">max</span>(EMPLOYMENT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cbsa_names, <span class="at">by =</span> <span class="st">"cbsa5"</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># NYC last winning year </span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>nyc_rows <span class="ot">&lt;-</span> w5182_winners <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^New York"</span>, NAME))</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>nyc_last_year <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">nrow</span>(nyc_rows) <span class="sc">==</span> <span class="dv">0</span>) <span class="cn">NA_integer_</span> <span class="cf">else</span> <span class="fu">max</span>(nyc_rows<span class="sc">$</span>YEAR)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>nyc_last_year_str <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">is.na</span>(nyc_last_year)) <span class="st">"never (2009–2023, excl. 2020)"</span> <span class="cf">else</span> <span class="fu">as.character</span>(nyc_last_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="indent-block-tab">
<p>New York City last led the nation in Data Science and Business Analyst employment in <strong>2015</strong>.</p>
</div>
</section>
<section id="question-5-what-fraction-of-total-wages-in-the-nyc-cbsa-was-earned-by-people-employed-in-the-finance-and-insurance-industries-naics-code-52-in-what-year-did-this-fraction-peak" class="level3">
<h3 class="anchored" data-anchor-id="question-5-what-fraction-of-total-wages-in-the-nyc-cbsa-was-earned-by-people-employed-in-the-finance-and-insurance-industries-naics-code-52-in-what-year-did-this-fraction-peak">Question 5: What fraction of total wages in the NYC CBSA was earned by people employed in the finance and insurance industries (NAICS code 52)? In what year did this fraction peak?</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>q5_fin_share <span class="ot">&lt;-</span> WAGES <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_cbsa5_bls</span>() <span class="sc">%&gt;%</span>                                      </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ind_chr =</span> <span class="fu">as.character</span>(INDUSTRY),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">ind_len =</span> <span class="fu">nchar</span>(ind_chr)) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ind_len <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span>                                </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cbsa5, YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_wages_2d =</span> <span class="fu">sum</span>(TOTAL_WAGES, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),      <span class="co"># total *sector* wages in the CBSA-year</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">finance_wages  =</span> <span class="fu">sum</span>(TOTAL_WAGES[ind_chr <span class="sc">==</span> <span class="st">"52"</span>],    <span class="co"># wages in Finance &amp; Insurance (NAICS 52)</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">finance_share =</span> finance_wages <span class="sc">/</span> total_wages_2d) <span class="sc">%&gt;%</span>  <span class="co"># share of wages in finance</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">left_join</span>(cbsa_names, <span class="at">by =</span> <span class="st">"cbsa5"</span>)                 </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the numeric CBSA id for New York metro</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>nyc_cbsa5 <span class="ot">&lt;-</span> cbsa_names <span class="sc">%&gt;%</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(NAME, <span class="st">"^New York"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(cbsa5)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Select NYC rows, then take the year with the highest finance_share</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>q5_nyc <span class="ot">&lt;-</span> q5_fin_share <span class="sc">%&gt;%</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cbsa5 <span class="sc">==</span> nyc_cbsa5) <span class="sc">%&gt;%</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(finance_share)) <span class="sc">%&gt;%</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="indent-block-tab">
<p>In <strong>2014</strong>, Finance &amp; Insurance reached its peak wage share in NYC at <strong>33%</strong>.</p>
</div>
</section>
</section>
<section id="task-3-initial-visualizations" class="level2">
<h2 class="anchored" data-anchor-id="task-3-initial-visualizations">Task 3: Initial Visualizations</h2>
<div class="indent-block-tab">
<p>Using the functions of the ggplot2 package, we will create suitable visualizations for each of the following relationships.</p>
</div>
<section id="relationship-1-the-relationship-between-monthly-rent-and-average-household-income-per-cbsa-in-2009." class="level3">
<h3 class="anchored" data-anchor-id="relationship-1-the-relationship-between-monthly-rent-and-average-household-income-per-cbsa-in-2009.">Relationship 1: The relationship between monthly rent and average household income per CBSA in 2009.</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>rent_income_2009 <span class="ot">&lt;-</span> INCOME <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2009</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(GEOID, NAME, household_income) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(RENT <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2009</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(GEOID, monthly_rent),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="st">"GEOID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cbsa5 =</span> <span class="fu">as.integer</span>(GEOID))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  rent_income_2009,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> household_income,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> monthly_rent,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> (monthly_rent <span class="sc">*</span> <span class="dv">12</span>) <span class="sc">/</span> household_income)  <span class="co"># rent-to-income ratio</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">option =</span> <span class="st">"RdBu"</span>,                 <span class="co"># high-contrast palette</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">end =</span> <span class="fl">0.95</span>,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Rent / Income"</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"2009 Monthly Rent vs. Household Income"</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Median Household Income (annual)"</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Median Gross Rent (monthly)"</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">linewidth =</span> <span class="fl">0.3</span>),</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">linewidth =</span> <span class="fl">0.2</span>)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="indent-block-tab">
<p>In 2009, metros with higher household income generally had higher monthly rent, and the colors suggest rent usually ran about 20–30% of income.</p>
</div>
</section>
<section id="relationship-2-the-relationship-between-total-employment-and-total-employment-in-the-health-care-and-social-services-sector-naics-62-across-different-cbsas.-design-your-visualization-so-that-it-is-possible-to-see-the-evolution-of-this-relationship-over-time." class="level3">
<h3 class="anchored" data-anchor-id="relationship-2-the-relationship-between-total-employment-and-total-employment-in-the-health-care-and-social-services-sector-naics-62-across-different-cbsas.-design-your-visualization-so-that-it-is-possible-to-see-the-evolution-of-this-relationship-over-time.">Relationship 2: The relationship between total employment and total employment in the health care and social services sector (NAICS 62) across different CBSAs. Design your visualization so that it is possible to see the evolution of this relationship over time.</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"emp_totals_2d"</span>)) {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  emp_totals_2d <span class="ot">&lt;-</span> WAGES <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_cbsa5_bls</span>() <span class="sc">%&gt;%</span>                                   </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ind =</span> <span class="fu">as.character</span>(INDUSTRY),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">ind_len =</span> <span class="fu">nchar</span>(ind)) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ind_len <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span>                              </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(cbsa5, YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_emp_2d =</span> <span class="fu">sum</span>(EMPLOYMENT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),              </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">hc_emp       =</span> <span class="fu">sum</span>(EMPLOYMENT[ind <span class="sc">==</span> <span class="st">"62"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(cbsa_names, <span class="at">by =</span> <span class="st">"cbsa5"</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># readable set of metros (top 40 by scale)</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"top40"</span>)) {</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  top40 <span class="ot">&lt;-</span> emp_totals_2d <span class="sc">%&gt;%</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(cbsa5) <span class="sc">%&gt;%</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">max_emp =</span> <span class="fu">max</span>(total_emp_2d, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(max_emp, <span class="at">n =</span> <span class="dv">40</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Compute HC share  </span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>emp_smallmult <span class="ot">&lt;-</span> emp_totals_2d <span class="sc">%&gt;%</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hc_share =</span> hc_emp <span class="sc">/</span> total_emp_2d) <span class="sc">%&gt;%</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(top40, <span class="at">by =</span> <span class="st">"cbsa5"</span>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">#Per-year metrics &amp; label: correlation (r) and OLS slope (β)</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>r_by_year <span class="ot">&lt;-</span> emp_smallmult <span class="sc">%&gt;%</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">r     =</span> <span class="fu">cor</span>(total_emp_2d, hc_emp, <span class="at">use =</span> <span class="st">"complete.obs"</span>),</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_x  =</span> <span class="fu">sd</span>(total_emp_2d, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_y  =</span> <span class="fu">sd</span>(hc_emp,       <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta  =</span> r <span class="sc">*</span> (sd_y <span class="sc">/</span> sd_x),</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_pos =</span> <span class="fu">max</span>(emp_smallmult<span class="sc">$</span>total_emp_2d, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="fl">0.95</span>,</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_pos =</span> <span class="fu">max</span>(emp_smallmult<span class="sc">$</span>hc_emp,       <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="fl">0.95</span>,</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab   =</span> <span class="fu">paste0</span>(<span class="st">"r = "</span>, <span class="fu">round</span>(r, <span class="dv">2</span>), <span class="st">" · β = "</span>, <span class="fu">round</span>(beta, <span class="dv">3</span>))</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot: one panel per year; color = HC share; line = per-year linear fit</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(emp_smallmult, <span class="fu">aes</span>(<span class="at">x =</span> total_emp_2d, <span class="at">y =</span> hc_emp, <span class="at">color =</span> hc_share)) <span class="sc">+</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.6</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"grey35"</span>) <span class="sc">+</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> YEAR, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"HC share of jobs"</span>,</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">accuracy =</span> <span class="dv">1</span>),</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">end =</span> <span class="fl">0.95</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">scale_cut =</span> scales<span class="sc">::</span><span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">scale_cut =</span> scales<span class="sc">::</span><span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> r_by_year,</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x_pos, <span class="at">y =</span> y_pos, <span class="at">label =</span> lab),</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"grey20"</span>) <span class="sc">+</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Health Care Employment vs. Total Employment"</span>,</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Total employment"</span>,</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Health Care Employment)"</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="indent-block-tab">
<p>Health care employment scales closely with total metro jobs, and in recent years the points suggests the sector is taking a bigger, steadier share of city employment over time.</p>
</div>
</section>
<section id="relationship-3-the-evolution-of-average-household-size-over-time." class="level3">
<h3 class="anchored" data-anchor-id="relationship-3-the-evolution-of-average-household-size-over-time.">Relationship 3: The evolution of average household size over time.</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>nyc_cbsa5 <span class="ot">&lt;-</span> cbsa_names <span class="sc">%&gt;%</span> <span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(NAME, <span class="st">"^New York"</span>)) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(cbsa5)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>la_cbsa5  <span class="ot">&lt;-</span> cbsa_names <span class="sc">%&gt;%</span> <span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(NAME, <span class="st">"^Los Angeles"</span>)) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(cbsa5)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build series and tag highlights</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>HHSIZE <span class="ot">&lt;-</span> POPULATION <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_cbsa5_census</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cbsa5, year, population) <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(HOUSEHOLDS <span class="sc">%&gt;%</span> <span class="fu">as_cbsa5_census</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(cbsa5, year, households),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cbsa5"</span>,<span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hh_size =</span> population <span class="sc">/</span> households) <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cbsa_names, <span class="at">by =</span> <span class="st">"cbsa5"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_highlight    =</span> cbsa5 <span class="sc">%in%</span> <span class="fu">c</span>(nyc_cbsa5, la_cbsa5),</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlight_label =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>      cbsa5 <span class="sc">==</span> nyc_cbsa5 <span class="sc">~</span> <span class="st">"NYC"</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>      cbsa5 <span class="sc">==</span> la_cbsa5  <span class="sc">~</span> <span class="st">"LA"</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>               <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Label positions (latest year) for the two highlights only</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>labels_df <span class="ot">&lt;-</span> HHSIZE <span class="sc">%&gt;%</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(is_highlight) <span class="sc">%&gt;%</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cbsa5) <span class="sc">%&gt;%</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="fu">max</span>(year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Others in light gray</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(HHSIZE, <span class="sc">!</span>is_highlight),</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> hh_size, <span class="at">group =</span> cbsa5),</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"grey78"</span>, <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">alpha =</span> <span class="fl">0.45</span>) <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># NYC &amp; LA in fixed colors</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(HHSIZE, is_highlight),</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> hh_size, <span class="at">color =</span> highlight_label, <span class="at">group =</span> cbsa5),</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.6</span>) <span class="sc">+</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Direct labels colored to match lines</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> labels_df,</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> hh_size, <span class="at">label =</span> NAME, <span class="at">color =</span> highlight_label),</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="fl">0.45</span>, <span class="at">direction =</span> <span class="st">"y"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">segment.alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">NYC =</span> <span class="st">"#D81B60"</span>, <span class="at">LA =</span> <span class="st">"#1E88E5"</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.16</span>))) <span class="sc">+</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Average Household Size over Time by CBSA"</span>,</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"NYC and LA "</span>,</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Average household size"</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="indent-block-tab">
<p>Most metros barely move over time, while NYC and LA sit on the higher end of household size and NYC drifts slightly downward across the period.</p>
</div>
</section>
</section>
<section id="task-4-rent-burden" class="level2">
<h2 class="anchored" data-anchor-id="task-4-rent-burden">Task 4: Rent Burden</h2>
<div class="indent-block-tab">
<p>Here we will be joining the Income and Rent tables to create suitable measure of rent burden. The ratio is scaled from 0-100 and this will show both a single metro’s trend and the highest/lowest CBSAs in the latest year.</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>rbi_tbl <span class="ot">&lt;-</span> INCOME <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_cbsa5_census</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cbsa5, year, household_income) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(RENT <span class="sc">%&gt;%</span> <span class="fu">as_cbsa5_census</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(cbsa5, year, monthly_rent),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cbsa5"</span>,<span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(POPULATION <span class="sc">%&gt;%</span> <span class="fu">as_cbsa5_census</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(cbsa5, year, population),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cbsa5"</span>,<span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">rent_to_income =</span> <span class="dv">12</span> <span class="sc">*</span> monthly_rent <span class="sc">/</span> household_income  <span class="co"># annualize rent</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cbsa_names, <span class="at">by =</span> <span class="st">"cbsa5"</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#deduping </span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>rbi_tbl <span class="ot">&lt;-</span> rbi_tbl <span class="sc">%&gt;%</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(cbsa5, year) <span class="sc">%&gt;%</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(cbsa5, year, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>name_canon <span class="ot">&lt;-</span> rbi_tbl <span class="sc">%&gt;%</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cbsa5) <span class="sc">%&gt;%</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="fu">max</span>(year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cbsa5, <span class="at">NAME_canon =</span> NAME)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>rbi_tbl <span class="ot">&lt;-</span> rbi_tbl <span class="sc">%&gt;%</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>NAME) <span class="sc">%&gt;%</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(name_canon, <span class="at">by =</span> <span class="st">"cbsa5"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">NAME =</span> NAME_canon)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Strict 0–100 scaling across ALL CBSA-years (0=min burden, 100=max) </span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>rti_min <span class="ot">&lt;-</span> <span class="fu">min</span>(rbi_tbl<span class="sc">$</span>rent_to_income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>rti_max <span class="ot">&lt;-</span> <span class="fu">max</span>(rbi_tbl<span class="sc">$</span>rent_to_income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>rbi_tbl <span class="ot">&lt;-</span> rbi_tbl <span class="sc">%&gt;%</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RBI_100 =</span> <span class="dv">100</span> <span class="sc">*</span> (rent_to_income <span class="sc">-</span> rti_min) <span class="sc">/</span> (rti_max <span class="sc">-</span> rti_min))</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 2009 U.S. (population-weighted) average on this 0–100 scale</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>us_rti_2009 <span class="ot">&lt;-</span> rbi_tbl <span class="sc">%&gt;%</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2009</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg =</span> <span class="fu">weighted.mean</span>(rent_to_income, <span class="at">w =</span> population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(avg)</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>us_rbi2009_on_100 <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (us_rti_2009 <span class="sc">-</span> rti_min) <span class="sc">/</span> (rti_max <span class="sc">-</span> rti_min)</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmltools)</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a><span class="co"># selector for NYC</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>focus_cbsa5 <span class="ot">&lt;-</span> <span class="dv">35620</span>L</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span>focus_cbsa5 <span class="sc">%in%</span> rbi_tbl<span class="sc">$</span>cbsa5) {</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>  fallback <span class="ot">&lt;-</span> cbsa_names <span class="sc">%&gt;%</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(NAME, <span class="st">"^New York"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(POPULATION <span class="sc">%&gt;%</span> <span class="fu">as_cbsa5_census</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2009</span>),</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="st">"cbsa5"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(population)) <span class="sc">%&gt;%</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(fallback) <span class="sc">&gt;</span> <span class="dv">0</span>) focus_cbsa5 <span class="ot">&lt;-</span> fallback<span class="sc">$</span>cbsa5[<span class="dv">1</span>]</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>focus_name <span class="ot">&lt;-</span> cbsa_names <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cbsa5 <span class="sc">==</span> focus_cbsa5) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(NAME)</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>focus_name <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">length</span>(focus_name) <span class="sc">==</span> <span class="dv">0</span>) <span class="st">"New York-Newark-Jersey City (NY Metro)"</span> <span class="cf">else</span> focus_name[<span class="dv">1</span>]</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a><span class="co">#Single metro over time </span></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>rbi_focus <span class="ot">&lt;-</span> rbi_tbl <span class="sc">%&gt;%</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cbsa5 <span class="sc">==</span> focus_cbsa5) <span class="sc">%&gt;%</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> year,</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Median Rent (mo)</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">dollar</span>(monthly_rent),</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Median HH Income</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">dollar</span>(household_income),</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Rent / Income</span><span class="st">`</span>    <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">percent</span>(rent_to_income, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">RBI (0–100)</span><span class="st">`</span>      <span class="ot">=</span> <span class="fu">round</span>(RBI_100, <span class="dv">1</span>)</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Title above the table </span></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">h4</span>(</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rent Burden over Time: "</span>, focus_name,</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">" (2009 U.S. avg ≈ "</span>, <span class="fu">round</span>(us_rbi2009_on_100, <span class="dv">1</span>), <span class="st">")"</span></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<h4 class="anchored">Rent Burden over Time: New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area (2009 U.S. avg ≈ 29.9)</h4>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  rbi_focus,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span>,  <span class="co"># default 10</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lengthMenu =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="fu">c</span>(<span class="st">"10"</span>, <span class="st">"25"</span>, <span class="st">"50"</span>, <span class="st">"100"</span>, <span class="st">"All"</span>)),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f7537e13c40c8a8978d5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f7537e13c40c8a8978d5">{"x":{"filter":"none","vertical":false,"data":[[2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2021,2022,2023],["$1,125","$1,150","$1,187","$1,209","$1,237","$1,281","$1,308","$1,346","$1,379","$1,434","$1,482","$1,600","$1,685","$1,764"],["$62,887","$61,927","$62,322","$63,982","$65,786","$67,066","$68,743","$71,897","$75,368","$78,478","$83,160","$84,409","$91,562","$95,220"],["21.5%","22.3%","22.9%","22.7%","22.6%","22.9%","22.8%","22.5%","22.0%","21.9%","21.4%","22.7%","22.1%","22.2%"],[35.4,38.5,40.7,40,39.6,41,40.6,39.2,37.3,37.1,35.1,40.3,37.8,38.3]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Year<\/th>\n      <th>Median Rent (mo)<\/th>\n      <th>Median HH Income<\/th>\n      <th>Rent / Income<\/th>\n      <th>RBI (0–100)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"lengthMenu":[[10,25,50,100,-1],["10","25","50","100","All"]],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[0,4]},{"name":"Year","targets":0},{"name":"Median Rent (mo)","targets":1},{"name":"Median HH Income","targets":2},{"name":"Rent / Income","targets":3},{"name":"RBI (0–100)","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Highest to Lowest (latest year; default 10)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>latest_year <span class="ot">&lt;-</span> <span class="fu">max</span>(rbi_tbl<span class="sc">$</span>year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>rbi_latest_desc <span class="ot">&lt;-</span> rbi_tbl <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> latest_year) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cbsa5) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RBI_100)) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">CBSA =</span> NAME,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> year,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">RBI (0–100)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(RBI_100, <span class="dv">1</span>),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Rent / Income</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">percent</span>(rent_to_income, <span class="at">accuracy =</span> <span class="fl">0.1</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">h4</span>(<span class="fu">paste0</span>(<span class="st">"Highest to Lowest Rent Burden ("</span>, latest_year, <span class="st">")"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<h4 class="anchored">Highest to Lowest Rent Burden (2023)</h4>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  rbi_latest_desc,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lengthMenu =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="fu">c</span>(<span class="st">"10"</span>, <span class="st">"25"</span>, <span class="st">"50"</span>, <span class="st">"100"</span>, <span class="st">"All"</span>)),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f38b53a079c25999376c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f38b53a079c25999376c">{"x":{"filter":"none","vertical":false,"data":[["Clearlake, CA Micro Area","Aguadilla-Isabela-San Sebasti?n, PR Metro Area","Cape Coral-Fort Myers, FL Metro Area","Miami-Fort Lauderdale-Pompano Beach, FL Metro Area","Port St. Lucie, FL Metro Area","Ponce, PR Metro Area","Tampa-St. Petersburg-Clearwater, FL Metro Area","Key West, FL Micro Area","North Port-Bradenton-Sarasota, FL Metro Area","Ocala, FL Metro Area","Orlando-Kissimmee, FL Metro Area","Salinas, CA Metro Area","Chico, CA Metro Area","Naples-Marco Island, FL Metro Area","Deltona-Daytona Beach-Ormond Beach, FL Metro Area","Merced, CA Metro Area","Guayama, PR Metro Area","Mayag?ez, PR Metro Area","Gainesville, FL Metro Area","San Diego-Carlsbad-San Marcos, CA Metro Area","Las Vegas-Paradise, NV Metro Area","Flagstaff, AZ Metro Area","Kahului-Wailuku, HI Micro Area","Santa Maria-Santa Barbara, CA Metro Area","Los Angeles-Long Beach-Anaheim, CA Metro Area","Panama City-Lynn Haven-Panama City Beach, FL Metro Area","Prescott Valley-Prescott, AZ Metro Area","Napa, CA Metro Area","Ukiah, CA Micro Area","Murrells Inlet, SC Micro Area","College Station-Bryan, TX Metro Area","San Luis Obispo-Paso Robles, CA Metro Area","Punta Gorda, FL Metro Area","Homosassa Springs, FL Micro Area","San Juan-Caguas-Guaynabo, PR Metro Area","Riverside-San Bernardino-Ontario, CA Metro Area","Hobbs, NM Micro Area","Oxnard-Thousand Oaks-Ventura, CA Metro Area","Palm Bay-Melbourne-Titusville, FL Metro Area","Sebring, FL Micro Area","Lakeland-Winter Haven, FL Metro Area","St. George, UT Metro Area","Hilton Head Island-Beaufort, SC Micro Area","Crestview-Fort Walton Beach-Destin, FL Metro Area","Arecibo, PR Metro Area","Vallejo-Fairfield, CA Metro Area","Ithaca, NY Metro Area","Phoenix-Mesa-Scottsdale, AZ Metro Area","Santa Rosa-Petaluma, CA Metro Area","Jacksonville, FL Metro Area","Truckee-Grass Valley, CA Micro Area","Eureka-Arcata-Fortuna, CA Micro Area","Lubbock, TX Metro Area","Boulder, CO Metro Area","Hilo, HI Micro Area","Bellingham, WA Metro Area","Watertown-Fort Drum, NY Micro Area","Fresno, CA Metro Area","Abilene, TX Metro Area","Fayetteville, NC Metro Area","San Angelo, TX Metro Area","Medford, OR Metro Area","Clovis, NM Micro Area","Urban Honolulu, HI Metro Area","Savannah, GA Metro Area","Atlanta-Sandy Springs-Marietta, GA Metro Area","Corpus Christi, TX Metro Area","Hinesville-Fort Stewart, GA Metro Area","Bozeman, MT Micro Area","Wilson, NC Micro Area","Eugene-Springfield, OR Metro Area","Santa Cruz-Watsonville, CA Metro Area","Coeur d'Alene, ID Metro Area","Tallahassee, FL Metro Area","Sebastian-Vero Beach, FL Metro Area","Reno-Sparks, NV Metro Area","Modesto, CA Metro Area","Charleston-North Charleston-Summerville, SC Metro Area","Fort Collins-Loveland, CO Metro Area","Albany-Lebanon, OR Micro Area","Lake Havasu City-Kingman, AZ Metro Area","Sherman-Denison, TX Metro Area","Lumberton, NC Micro Area","Florence, SC Metro Area","Gallup, NM Micro Area","El Paso, TX Metro Area","Olympia, WA Metro Area","Bluefield, WV-VA Micro Area","Alamogordo, NM Micro Area","New Orleans-Metairie-Kenner, LA Metro Area","Colorado Springs, CO Metro Area","Sierra Vista-Douglas, AZ Micro Area","Asheville, NC Metro Area","Huntsville, TX Micro Area","Sacramento--Arden-Arcade--Roseville, CA Metro Area","Clarksville, TN-KY Metro Area","LaGrange, GA Micro Area","Stockton, CA Metro Area","Bloomington, IN Metro Area","Dallas-Fort Worth-Arlington, TX Metro Area","Athens-Clarke County, GA Metro Area","Bend, OR Metro Area","Texarkana, TX-Texarkana, AR Metro Area","Klamath Falls, OR Micro Area","Lufkin, TX Micro Area","Granbury, TX Micro Area","San Francisco-Oakland-Fremont, CA Metro Area","Memphis, TN-MS-AR Metro Area","Shreveport-Bossier City, LA Metro Area","Corvallis, OR Metro Area","Bakersfield, CA Metro Area","Salem, OR Metro Area","Jacksonville, NC Metro Area","East Stroudsburg, PA Micro Area","Monroe, LA Metro Area","Pine Bluff, AR Metro Area","Wilmington, NC Metro Area","New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area","Charlotte-Gastonia-Concord, NC-SC Metro Area","Nashville-Davidson--Murfreesboro--Franklin, TN Metro Area","Virginia Beach-Norfolk-Newport News, VA-NC Metro Area","Mobile, AL Metro Area","Palatka, FL Micro Area","Vineland-Millville-Bridgeton, NJ Metro Area","Denver-Aurora-Broomfield, CO Metro Area","Durham-Chapel Hill, NC Metro Area","Pikeville, KY Micro Area","Hanford-Corcoran, CA Metro Area","Shelton, WA Micro Area","Myrtle Beach-North Myrtle Beach-Conway, SC Metro Area","Danville, VA Metro Area","San Antonio, TX Metro Area","Killeen-Temple-Fort Hood, TX Metro Area","Boise City-Nampa, ID Metro Area","Grand Junction, CO Metro Area","Danville, IL Metro Area","Mount Vernon-Anacortes, WA Metro Area","Valdosta, GA Metro Area","Columbus, GA-AL Metro Area","New Haven-Milford, CT Metro Area","Grants Pass, OR Micro Area","Bremerton-Silverdale, WA Metro Area","Hammond, LA Micro Area","Tucson, AZ Metro Area","Dover, DE Metro Area","San Jose-Sunnyvale-Santa Clara, CA Metro Area","Carson City, NV Metro Area","Oak Harbor, WA Micro Area","Boston-Cambridge-Quincy, MA-NH Metro Area","Hot Springs, AR Metro Area","Houston-Sugar Land-Baytown, TX Metro Area","Heber, UT Micro Area","Wildwood-The Villages, FL Metro Area","Hattiesburg, MS Metro Area","Salisbury, MD Metro Area","Rio Grande City-Roma, TX Micro Area","Scranton--Wilkes-Barre, PA Metro Area","Tyler, TX Metro Area","Blacksburg-Christiansburg-Radford, VA Metro Area","Lafayette-West Lafayette, IN Metro Area","Pueblo, CO Metro Area","Barnstable Town, MA Metro Area","Redding, CA Metro Area","Austin-Round Rock, TX Metro Area","Albuquerque, NM Metro Area","Waco, TX Metro Area","Seattle-Tacoma-Bellevue, WA Metro Area","New Bern, NC Micro Area","Richmond, VA Metro Area","Chattanooga, TN-GA Metro Area","Houma-Bayou Cane-Thibodaux, LA Metro Area","Daphne-Fairhope-Foley, AL Micro Area","Portland-Vancouver-Beaverton, OR-WA Metro Area","Spokane, WA Metro Area","Odessa, TX Metro Area","Yuba City, CA Metro Area","Pensacola-Ferry Pass-Brent, FL Metro Area","Kapaa, HI Micro Area","Beaumont-Port Arthur, TX Metro Area","Visalia-Porterville, CA Metro Area","Alexandria, LA Metro Area","Gainesville, GA Metro Area","Jackson, MS Metro Area","McAllen-Edinburg-Mission, TX Metro Area","Greensboro-High Point, NC Metro Area","Columbia, SC Metro Area","Fairbanks, AK Metro Area","Greenville, NC Metro Area","Salt Lake City, UT Metro Area","Lawton, OK Metro Area","State College, PA Metro Area","Ann Arbor, MI Metro Area","Brownsville-Harlingen, TX Metro Area","Brunswick, GA Metro Area","Terre Haute, IN Metro Area","Greeley, CO Metro Area","Meridian, MS Micro Area","Gulfport-Biloxi, MS Metro Area","Pinehurst-Southern Pines, NC Micro Area","Kalispell, MT Micro Area","Show Low, AZ Micro Area","Staunton-Waynesboro, VA Micro Area","Macon, GA Metro Area","Nacogdoches, TX Micro Area","Roseburg, OR Micro Area","Baton Rouge, LA Metro Area","Statesboro, GA Micro Area","Elmira, NY Metro Area","El Centro, CA Metro Area","Springfield, MA Metro Area","Amherst Town-Northampton, MA Metro Area","Corbin, KY Micro Area","Stillwater, OK Micro Area","Portland-South Portland-Biddeford, ME Metro Area","Farmington, NM Metro Area","Jackson, TN Metro Area","Greenville-Mauldin-Easley, SC Metro Area","Athens, TX Micro Area","Manhattan, KS Metro Area","Kiryas Joel-Poughkeepsie-Newburgh, NY Metro Area","Twin Falls, ID Micro Area","Burlington-South Burlington, VT Metro Area","Goldsboro, NC Metro Area","Thomasville, GA Micro Area","Auburn-Opelika, AL Metro Area","Yuma, AZ Metro Area","Bridgeport-Stamford-Norwalk, CT Metro Area","Philadelphia-Camden-Wilmington, PA-NJ-DE-MD Metro Area","Rexburg, ID Micro Area","Knoxville, TN Metro Area","Raleigh-Cary, NC Metro Area","Forest City, NC Micro Area","Charlottesville, VA Metro Area","Bangor, ME Metro Area","Birmingham-Hoover, AL Metro Area","Sumter, SC Metro Area","Lancaster, PA Metro Area","Allentown-Bethlehem-Easton, PA-NJ Metro Area","Victoria, TX Metro Area","Roanoke, VA Metro Area","Dothan, AL Metro Area","Port Angeles, WA Micro Area","Longview, WA Metro Area","Las Cruces, NM Metro Area","Baltimore-Towson, MD Metro Area","Lafayette, LA Metro Area","Eagle Pass, TX Metro Area","Atlantic City-Hammonton, NJ Metro Area","Traverse City, MI Micro Area","Slidell-Mandeville-Covington, LA Metro Area","Augusta-Waterville, ME Micro Area","Tuscaloosa, AL Metro Area","Laredo, TX Metro Area","Spartanburg, SC Metro Area","Johnson City, TN Metro Area","Longview, TX Metro Area","Lake City, FL Micro Area","Rifle, CO Micro Area","Tulsa, OK Metro Area","Augusta-Richmond County, GA-SC Metro Area","Muskegon-Norton Shores, MI Metro Area","Greenfield Town, MA Micro Area","Montgomery, AL Metro Area","Oklahoma City, OK Metro Area","Norwich-New London, CT Metro Area","Detroit-Warren-Livonia, MI Metro Area","Marion-Herrin, IL Micro Area","Sevierville, TN Micro Area","Madison, WI Metro Area","Lake Charles, LA Metro Area","Columbus, OH Metro Area","Kenosha, WI Metro Area","Albany, GA Metro Area","Orangeburg, SC Micro Area","Reading, PA Metro Area","Yakima, WA Metro Area","Manchester-Nashua, NH Metro Area","Centralia, WA Micro Area","South Bend-Mishawaka, IN-MI Metro Area","Elkhart-Goshen, IN Metro Area","Jonesboro, AR Metro Area","Washington-Arlington-Alexandria, DC-VA-MD-WV Metro Area","Rome, GA Metro Area","Beckley, WV Micro Area","Chicago-Naperville-Joliet, IL-IN-WI Metro Area","Providence-New Bedford-Fall River, RI-MA Metro Area","Waterbury-Shelton, CT Metro Area","Lexington-Fayette, KY Metro Area","Greenwood, SC Micro Area","Santa Fe, NM Metro Area","Richmond, IN Micro Area","Muncie, IN Metro Area","Missoula, MT Metro Area","Opelousas-Eunice, LA Micro Area","Kingston, NY Metro Area","Kankakee-Bradley, IL Metro Area","Seaford, DE Micro Area","Champaign-Urbana, IL Metro Area","Michigan City-La Porte, IN Metro Area","Cleveland, TN Metro Area","Lawrence, KS Metro Area","Battle Creek, MI Metro Area","Amarillo, TX Metro Area","Kalamazoo-Portage, MI Metro Area","Fayetteville-Springdale-Rogers, AR-MO Metro Area","Burlington, NC Metro Area","Winchester, VA-WV Metro Area","Lewiston-Auburn, ME Metro Area","Louisville-Jefferson County, KY-IN Metro Area","Albany-Schenectady-Troy, NY Metro Area","New Iberia, LA Micro Area","Idaho Falls, ID Metro Area","Oxford, MS Micro Area","Springfield, MO Metro Area","Kennewick-Pasco-Richland, WA Metro Area","Columbia, MO Metro Area","Pocatello, ID Metro Area","Charleston, WV Metro Area","Harrisburg-Carlisle, PA Metro Area","Little Rock-North Little Rock-Conway, AR Metro Area","Lewiston, ID-WA Metro Area","Kansas City, MO-KS Metro Area","Rochester, NY Metro Area","Altoona, PA Metro Area","Anderson Creek, NC Micro Area","Kokomo, IN Metro Area","Aberdeen, WA Micro Area","Indianapolis-Carmel, IN Metro Area","Grand Rapids-Wyoming, MI Metro Area","Saginaw-Saginaw Township North, MI Metro Area","Morristown, TN Metro Area","Flint, MI Metro Area","Provo-Orem, UT Metro Area","Portsmouth, OH Micro Area","Winston-Salem, NC Metro Area","Lebanon-Claremont, NH-VT Micro Area","Hagerstown-Martinsburg, MD-WV Metro Area","Hermiston-Pendleton, OR Micro Area","Anniston-Oxford, AL Metro Area","Worcester, MA Metro Area","Wenatchee-East Wenatchee, WA Metro Area","Joplin, MO Metro Area","Youngstown-Warren-Boardman, OH-PA Metro Area","Owosso, MI Micro Area","Dayton-Kettering, OH Metro Area","Morgantown, WV Metro Area","Cleveland, OH Metro Area","Somerset, KY Micro Area","Trenton-Ewing, NJ Metro Area","Muskogee, OK Micro Area","Bowling Green, KY Metro Area","Warner Robins, GA Metro Area","Jackson, MI Metro Area","Cheyenne, WY Metro Area","Ogden-Clearfield, UT Metro Area","Concord, NH Micro Area","Anchorage, AK Metro Area","Harrisonburg, VA Metro Area","Hartford-West Hartford-East Hartford, CT Metro Area","Fort Payne, AL Micro Area","Plattsburgh, NY Micro Area","Buffalo-Niagara Falls, NY Metro Area","Kingsport-Bristol-Bristol, TN-VA Metro Area","Lebanon, PA Metro Area","Wichita Falls, TX Metro Area","Minneapolis-St. Paul-Bloomington, MN-WI Metro Area","Niles-Benton Harbor, MI Metro Area","Enid, OK Metro Area","Rochester, MN Metro Area","Iowa City, IA Metro Area","Waterloo-Cedar Falls, IA Metro Area","Lansing-East Lansing, MI Metro Area","Utica-Rome, NY Metro Area","Whitewater, WI Micro Area","Zanesville, OH Micro Area","Monticello, NY Micro Area","Rockford, IL Metro Area","Lexington Park, MD Micro Area","Erie, PA Metro Area","Logan, UT-ID Metro Area","Shawnee, OK Micro Area","Toledo, OH Metro Area","Mankato-North Mankato, MN Metro Area","Cookeville, TN Micro Area","Akron, OH Metro Area","Russellville, AR Micro Area","Fort Smith, AR-OK Metro Area","Morehead City, NC Micro Area","Huntsville, AL Metro Area","Topeka, KS Metro Area","Farmington, MO Micro Area","Rapid City, SD Metro Area","Milwaukee-Waukesha-West Allis, WI Metro Area","Cumberland, MD-WV Metro Area","Syracuse, NY Metro Area","Gadsden, AL Metro Area","Evansville, IN-KY Metro Area","Searcy, AR Micro Area","Casper, WY Metro Area","Clarksburg, WV Micro Area","Lynchburg, VA Metro Area","Brigham City, UT-ID Micro Area","Chambersburg, PA Micro Area","Great Falls, MT Metro Area","Jamestown-Dunkirk-Fredonia, NY Micro Area","Adrian, MI Micro Area","Sioux City, IA-NE-SD Metro Area","Walla Walla, WA Metro Area","Rocky Mount, NC Metro Area","Warsaw, IN Micro Area","Pittsburgh, PA Metro Area","Binghamton, NY Metro Area","Huntington-Ashland, WV-KY-OH Metro Area","Sanford, NC Micro Area","Brainerd, MN Micro Area","Omaha-Council Bluffs, NE-IA Metro Area","St. Joseph, MO-KS Metro Area","Wichita, KS Metro Area","Lincoln, NE Metro Area","Quincy, IL-MO Micro Area","Owensboro, KY Metro Area","Columbus, IN Metro Area","Midland, TX Metro Area","Mansfield, OH Metro Area","Chillicothe, OH Micro Area","Hickory-Lenoir-Morganton, NC Metro Area","Weirton-Steubenville, WV-OH Metro Area","Fort Wayne, IN Metro Area","Hermitage, PA Micro Area","Helena, MT Micro Area","Shelby, NC Micro Area","Duluth, MN-WI Metro Area","Cincinnati-Middletown, OH-KY-IN Metro Area","Billings, MT Metro Area","Salem, OH Micro Area","York-Hanover, PA Metro Area","Elizabethtown, KY Metro Area","Decatur, IL Metro Area","Keene, NH Micro Area","St. Louis, MO-IL Metro Area","Lima, OH Metro Area","Dalton, GA Metro Area","Marion, IN Micro Area","Tullahoma, TN Micro Area","St. Cloud, MN Metro Area","Racine, WI Metro Area","New Philadelphia-Dover, OH Micro Area","Laurel, MS Micro Area","Williamsport, PA Metro Area","Moses Lake, WA Micro Area","Findlay, OH Micro Area","Auburn, NY Micro Area","Holland, MI Micro Area","North Wilkesboro, NC Micro Area","Canton-Massillon, OH Metro Area","Massena-Ogdensburg, NY Micro Area","Pittsfield, MA Metro Area","Gettysburg, PA Micro Area","Bay City, MI Metro Area","Monroe, MI Metro Area","Des Moines-West Des Moines, IA Metro Area","Putnam, CT Micro Area","Indiana, PA Micro Area","Minot, ND Micro Area","Stevens Point, WI Micro Area","Bloomsburg-Berwick, PA Micro Area","Ames, IA Metro Area","La Crosse, WI-MN Metro Area","Sandusky, OH Metro Area","Greeneville, TN Micro Area","Fargo, ND-MN Metro Area","Springfield, OH Metro Area","Marquette, MI Micro Area","Fond du Lac, WI Metro Area","Glens Falls, NY Metro Area","Baraboo, WI Micro Area","Parkersburg-Marietta-Vienna, WV-OH Metro Area","Cullman, AL Micro Area","Grand Island, NE Micro Area","Beaver Dam, WI Micro Area","Oshkosh-Neenah, WI Metro Area","Janesville, WI Metro Area","Green Bay, WI Metro Area","Sunbury, PA Micro Area","Springfield, IL Metro Area","Olean, NY Micro Area","Wausau, WI Metro Area","Wheeling, WV-OH Metro Area","Peoria, IL Metro Area","Bloomington, IL Metro Area","Somerset, PA Micro Area","Jefferson, GA Micro Area","Tupelo, MS Micro Area","Albemarle, NC Micro Area","Eau Claire, WI Metro Area","Corning, NY Micro Area","Cape Girardeau-Jackson, MO-IL Metro Area","DuBois, PA Micro Area","Johnstown, PA Metro Area","Sioux Falls, SD Metro Area","Appleton, WI Metro Area","Davenport-Moline-Rock Island, IA-IL Metro Area","Athens, TN Micro Area","Wooster, OH Micro Area","Grand Forks, ND-MN Metro Area","Faribault-Northfield, MN Micro Area","Frankfort, KY Micro Area","Meadville, PA Micro Area","Torrington, CT Micro Area","Cedar Rapids, IA Metro Area","Richmond-Berea, KY Micro Area","Marinette, WI-MI Micro Area","Pottsville, PA Micro Area","Ottawa, IL Micro Area","Florence-Muscle Shoals, AL Metro Area","Sheboygan, WI Metro Area","Midland, MI Micro Area","Paducah, KY-IL Micro Area","Seneca, SC Micro Area","Dubuque, IA Metro Area","Albertville, AL Micro Area","Mount Airy, NC Micro Area","Talladega-Sylacauga, AL Micro Area","Decatur, AL Metro Area","Jefferson City, MO Metro Area","Wisconsin Rapids-Marshfield, WI Micro Area","Watertown-Fort Atkinson, WI Micro Area","Bismarck, ND Metro Area","Manitowoc, WI Micro Area","Laconia, NH Micro Area"],[2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023],[72.90000000000001,71.8,68.90000000000001,68.8,66.40000000000001,63.4,62.6,61.5,61.4,60.4,60.2,58,57.6,57.4,57.1,56.6,56.5,56.1,55.4,55.1,54.6,54.5,53.7,53.5,52.9,52.6,51.9,51.6,51.3,51.1,50.8,50.7,50.6,50.5,50.5,50.1,50,49.9,49.7,49.7,49.6,49.6,49.4,49.2,49,47.9,47.8,47.6,47.3,46.5,46.3,46.2,45.7,45.5,45.2,45.1,44.9,44.8,44.8,44.8,44.8,44.2,43.9,43.8,43.8,43.6,43.5,43.5,43.5,43.4,42.9,42.6,42.4,42.1,42,41.8,41.8,41.8,41.8,41.7,41.7,41.4,41.3,41.2,41.2,40.9,40.8,40.7,40.6,40.5,40.5,40.5,40.3,40.3,40.3,40.3,40.2,40.2,40.1,39.9,39.8,39.7,39.6,39.5,39.5,39.4,39.4,39.3,39.3,39.3,39,38.9,38.9,38.8,38.7,38.7,38.4,38.3,38.3,38.2,38.1,38,38,37.9,37.8,37.7,37.7,37.6,37.6,37.4,37.4,37.4,37.4,37.3,37.2,37.2,37.1,37.1,37.1,36.9,36.7,36.6,36.5,36.4,36.4,36.3,36.3,36.2,36.2,36.2,36,36,36,36,35.9,35.8,35.7,35.7,35.7,35.6,35.3,35.2,34.9,34.9,34.9,34.8,34.7,34.5,34.4,34.4,34.3,34.2,34,33.9,33.8,33.8,33.8,33.7,33.5,33.4,33.4,33.4,33.4,33.3,33.2,33.1,33.1,33,32.9,32.9,32.8,32.8,32.7,32.4,32.4,32.3,32.2,32.2,32.1,32,31.8,31.8,31.7,31.6,31.5,31.4,31.2,31.2,31.1,31,31,31,30.8,30.5,30.5,30.5,30.4,30.4,30.3,30.3,30.3,30.3,30.3,30.2,30.2,30.2,30.2,30.1,30.1,30.1,29.9,29.8,29.8,29.7,29.6,29.5,29.4,29.4,29.4,29.3,29.3,29.3,29.3,29.1,29,29,28.9,28.9,28.9,28.8,28.8,28.8,28.7,28.6,28.6,28.5,28.5,28.5,28.5,28.4,28.4,28.1,28.1,28,28,28,28,27.8,27.8,27.7,27.6,27.5,27.4,27.3,27.1,27.1,27,27,26.9,26.9,26.9,26.7,26.6,26.5,26.4,26.4,26.4,26.4,26.3,26.3,26.3,26.2,26.2,26.1,26,25.9,25.8,25.8,25.7,25.7,25.5,25.5,25.5,25.4,25.4,25.4,25.4,25.3,25.3,25.2,25.1,24.9,24.9,24.9,24.9,24.9,24.7,24.6,24.6,24.6,24.6,24.4,24.4,24.3,24.3,24.2,24.2,24.2,24.2,24.2,24.1,24.1,24,24,24,24,23.9,23.9,23.8,23.8,23.8,23.7,23.6,23.4,23.4,23.3,23.2,23.2,23.1,23.1,23,23,23,23,22.9,22.8,22.8,22.7,22.7,22.7,22.5,22.4,22.2,22.2,22.1,22,21.9,21.7,21.6,21.6,21.5,21.4,21.4,21.2,21.2,21.1,21,20.9,20.8,20.7,20.6,20.6,20.5,20.5,20.5,20.4,20.2,20.2,20.1,20.1,20.1,20,20,20,19.9,19.9,19.9,19.8,19.8,19.7,19.7,19.4,19.3,19.3,19.3,19.3,19.2,19.2,19.2,19.2,19.2,19.1,19.1,19,19,19,18.9,18.8,18.8,18.8,18.7,18.7,18.6,18.5,18.5,18.4,18.4,18.2,18.1,18.1,18,18,18,18,18,17.9,17.9,17.8,17.8,17.7,17.7,17.6,17.6,17.6,17.5,17.5,17.5,17.4,17.3,17.3,17.3,17.2,17,17,16.9,16.8,16.7,16.5,16.5,16.2,16.2,16,16,15.8,15.8,15.8,15.6,15.5,15.5,15.4,15.3,15.3,15.3,15.1,15,14.7,14.5,14.4,14.3,14.1,14,13.9,13.7,13.6,13.6,13.5,13.5,13.3,13.3,13.3,13.3,13.2,13.1,13.1,13,12.9,12.8,12.8,12.7,12.5,12.5,12.2,12.2,11.9,11.3,10.9,10.8,10.7,10.5,10.5,10.5,10.4,10.2,9.699999999999999,9.5,9.300000000000001,9.199999999999999,9.1,8.699999999999999,8.4,8.1,7.9,7.3,6.7,5.9,5.9,5.8,5.3,3.5,1.6],["31.2%","30.9%","30.1%","30.1%","29.5%","28.7%","28.5%","28.2%","28.2%","27.9%","27.9%","27.3%","27.2%","27.2%","27.1%","27.0%","26.9%","26.8%","26.7%","26.6%","26.4%","26.4%","26.2%","26.2%","26.0%","25.9%","25.7%","25.7%","25.6%","25.5%","25.5%","25.4%","25.4%","25.4%","25.4%","25.3%","25.3%","25.2%","25.2%","25.2%","25.2%","25.2%","25.1%","25.1%","25.0%","24.7%","24.7%","24.6%","24.6%","24.4%","24.3%","24.3%","24.2%","24.1%","24.0%","24.0%","23.9%","23.9%","23.9%","23.9%","23.9%","23.8%","23.7%","23.7%","23.7%","23.6%","23.6%","23.6%","23.6%","23.5%","23.4%","23.3%","23.3%","23.2%","23.2%","23.1%","23.1%","23.1%","23.1%","23.1%","23.1%","23.0%","23.0%","23.0%","23.0%","22.9%","22.9%","22.8%","22.8%","22.8%","22.8%","22.8%","22.7%","22.7%","22.7%","22.7%","22.7%","22.7%","22.7%","22.6%","22.6%","22.6%","22.6%","22.5%","22.5%","22.5%","22.5%","22.5%","22.5%","22.5%","22.4%","22.4%","22.4%","22.4%","22.3%","22.3%","22.3%","22.2%","22.2%","22.2%","22.2%","22.2%","22.1%","22.1%","22.1%","22.1%","22.1%","22.0%","22.0%","22.0%","22.0%","22.0%","22.0%","22.0%","22.0%","21.9%","21.9%","21.9%","21.9%","21.9%","21.8%","21.8%","21.8%","21.7%","21.7%","21.7%","21.7%","21.7%","21.7%","21.7%","21.6%","21.6%","21.6%","21.6%","21.6%","21.6%","21.6%","21.6%","21.5%","21.5%","21.5%","21.4%","21.3%","21.3%","21.3%","21.3%","21.3%","21.2%","21.2%","21.2%","21.2%","21.2%","21.1%","21.1%","21.1%","21.1%","21.1%","21.0%","21.0%","21.0%","21.0%","21.0%","21.0%","20.9%","20.9%","20.9%","20.9%","20.9%","20.8%","20.8%","20.8%","20.8%","20.8%","20.7%","20.7%","20.7%","20.6%","20.6%","20.6%","20.6%","20.5%","20.5%","20.5%","20.5%","20.5%","20.4%","20.4%","20.4%","20.4%","20.3%","20.3%","20.3%","20.3%","20.2%","20.2%","20.2%","20.2%","20.2%","20.2%","20.2%","20.2%","20.2%","20.1%","20.1%","20.1%","20.1%","20.1%","20.1%","20.1%","20.1%","20.0%","20.0%","20.0%","20.0%","20.0%","20.0%","19.9%","19.9%","19.9%","19.9%","19.9%","19.9%","19.9%","19.8%","19.8%","19.8%","19.8%","19.8%","19.8%","19.8%","19.8%","19.8%","19.7%","19.7%","19.7%","19.7%","19.7%","19.7%","19.7%","19.7%","19.7%","19.6%","19.6%","19.6%","19.6%","19.6%","19.6%","19.5%","19.5%","19.5%","19.4%","19.4%","19.4%","19.4%","19.3%","19.3%","19.3%","19.3%","19.3%","19.3%","19.3%","19.2%","19.2%","19.2%","19.2%","19.2%","19.2%","19.1%","19.1%","19.1%","19.1%","19.1%","19.1%","19.1%","19.0%","19.0%","19.0%","19.0%","19.0%","19.0%","18.9%","18.9%","18.9%","18.9%","18.9%","18.9%","18.9%","18.9%","18.9%","18.8%","18.8%","18.8%","18.8%","18.8%","18.8%","18.8%","18.7%","18.7%","18.7%","18.7%","18.7%","18.6%","18.6%","18.6%","18.6%","18.6%","18.6%","18.6%","18.6%","18.6%","18.6%","18.6%","18.5%","18.5%","18.5%","18.5%","18.5%","18.5%","18.5%","18.5%","18.5%","18.4%","18.4%","18.4%","18.4%","18.4%","18.3%","18.3%","18.3%","18.3%","18.3%","18.3%","18.3%","18.3%","18.3%","18.2%","18.2%","18.2%","18.2%","18.2%","18.1%","18.1%","18.1%","18.1%","18.0%","18.0%","18.0%","17.9%","17.9%","17.9%","17.9%","17.9%","17.8%","17.8%","17.8%","17.8%","17.8%","17.7%","17.7%","17.7%","17.6%","17.6%","17.6%","17.6%","17.6%","17.6%","17.5%","17.5%","17.5%","17.5%","17.5%","17.5%","17.5%","17.5%","17.5%","17.5%","17.5%","17.4%","17.4%","17.4%","17.4%","17.3%","17.3%","17.3%","17.3%","17.3%","17.3%","17.3%","17.3%","17.3%","17.3%","17.3%","17.2%","17.2%","17.2%","17.2%","17.2%","17.2%","17.2%","17.2%","17.2%","17.1%","17.1%","17.1%","17.1%","17.1%","17.1%","17.0%","17.0%","17.0%","17.0%","17.0%","17.0%","17.0%","17.0%","16.9%","16.9%","16.9%","16.9%","16.9%","16.9%","16.9%","16.9%","16.9%","16.8%","16.8%","16.8%","16.8%","16.8%","16.8%","16.8%","16.8%","16.7%","16.7%","16.7%","16.6%","16.6%","16.6%","16.6%","16.5%","16.5%","16.4%","16.4%","16.4%","16.4%","16.4%","16.3%","16.3%","16.3%","16.3%","16.3%","16.3%","16.3%","16.2%","16.2%","16.1%","16.1%","16.0%","16.0%","16.0%","15.9%","15.9%","15.9%","15.8%","15.8%","15.8%","15.8%","15.8%","15.7%","15.7%","15.7%","15.7%","15.7%","15.7%","15.7%","15.7%","15.6%","15.6%","15.6%","15.6%","15.5%","15.5%","15.5%","15.4%","15.2%","15.1%","15.1%","15.1%","15.0%","15.0%","15.0%","15.0%","15.0%","14.8%","14.8%","14.7%","14.7%","14.7%","14.6%","14.5%","14.4%","14.3%","14.2%","14.0%","13.8%","13.8%","13.8%","13.7%","13.2%","12.7%"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>CBSA<\/th>\n      <th>Year<\/th>\n      <th>RBI (0–100)<\/th>\n      <th>Rent / Income<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"lengthMenu":[[10,25,50,100,-1],["10","25","50","100","All"]],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2]},{"name":"CBSA","targets":0},{"name":"Year","targets":1},{"name":"RBI (0–100)","targets":2},{"name":"Rent / Income","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lowest to Highest (same data ascending; default 10)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>rbi_latest_asc <span class="ot">&lt;-</span> rbi_latest_desc <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="st">`</span><span class="at">RBI (0–100)</span><span class="st">`</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">h4</span>(<span class="fu">paste0</span>(<span class="st">"Lowest to Highest Rent Burden ("</span>, latest_year, <span class="st">")"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<h4 class="anchored">Lowest to Highest Rent Burden (2023)</h4>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  rbi_latest_asc,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lengthMenu =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="fu">c</span>(<span class="st">"10"</span>, <span class="st">"25"</span>, <span class="st">"50"</span>, <span class="st">"100"</span>, <span class="st">"All"</span>)),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-1cf7c9edefb285f27e61" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1cf7c9edefb285f27e61">{"x":{"filter":"none","vertical":false,"data":[["Laconia, NH Micro Area","Manitowoc, WI Micro Area","Bismarck, ND Metro Area","Watertown-Fort Atkinson, WI Micro Area","Jefferson City, MO Metro Area","Wisconsin Rapids-Marshfield, WI Micro Area","Decatur, AL Metro Area","Talladega-Sylacauga, AL Micro Area","Mount Airy, NC Micro Area","Albertville, AL Micro Area","Dubuque, IA Metro Area","Seneca, SC Micro Area","Paducah, KY-IL Micro Area","Midland, MI Micro Area","Sheboygan, WI Metro Area","Florence-Muscle Shoals, AL Metro Area","Ottawa, IL Micro Area","Pottsville, PA Micro Area","Marinette, WI-MI Micro Area","Torrington, CT Micro Area","Cedar Rapids, IA Metro Area","Richmond-Berea, KY Micro Area","Meadville, PA Micro Area","Frankfort, KY Micro Area","Faribault-Northfield, MN Micro Area","Grand Forks, ND-MN Metro Area","Wooster, OH Micro Area","Davenport-Moline-Rock Island, IA-IL Metro Area","Athens, TN Micro Area","Sioux Falls, SD Metro Area","Appleton, WI Metro Area","Johnstown, PA Metro Area","Cape Girardeau-Jackson, MO-IL Metro Area","DuBois, PA Micro Area","Corning, NY Micro Area","Eau Claire, WI Metro Area","Tupelo, MS Micro Area","Albemarle, NC Micro Area","Jefferson, GA Micro Area","Wheeling, WV-OH Metro Area","Peoria, IL Metro Area","Bloomington, IL Metro Area","Somerset, PA Micro Area","Olean, NY Micro Area","Wausau, WI Metro Area","Sunbury, PA Micro Area","Springfield, IL Metro Area","Green Bay, WI Metro Area","Janesville, WI Metro Area","Oshkosh-Neenah, WI Metro Area","Beaver Dam, WI Micro Area","Grand Island, NE Micro Area","Cullman, AL Micro Area","Parkersburg-Marietta-Vienna, WV-OH Metro Area","Baraboo, WI Micro Area","Glens Falls, NY Metro Area","Fond du Lac, WI Metro Area","Fargo, ND-MN Metro Area","Springfield, OH Metro Area","Marquette, MI Micro Area","Greeneville, TN Micro Area","La Crosse, WI-MN Metro Area","Sandusky, OH Metro Area","Ames, IA Metro Area","Minot, ND Micro Area","Stevens Point, WI Micro Area","Bloomsburg-Berwick, PA Micro Area","Putnam, CT Micro Area","Indiana, PA Micro Area","Monroe, MI Metro Area","Des Moines-West Des Moines, IA Metro Area","Gettysburg, PA Micro Area","Bay City, MI Metro Area","Pittsfield, MA Metro Area","Massena-Ogdensburg, NY Micro Area","Canton-Massillon, OH Metro Area","Holland, MI Micro Area","North Wilkesboro, NC Micro Area","Auburn, NY Micro Area","Williamsport, PA Metro Area","Moses Lake, WA Micro Area","Findlay, OH Micro Area","Laurel, MS Micro Area","St. Cloud, MN Metro Area","Racine, WI Metro Area","New Philadelphia-Dover, OH Micro Area","Dalton, GA Metro Area","Marion, IN Micro Area","Tullahoma, TN Micro Area","St. Louis, MO-IL Metro Area","Lima, OH Metro Area","Decatur, IL Metro Area","Keene, NH Micro Area","York-Hanover, PA Metro Area","Elizabethtown, KY Metro Area","Shelby, NC Micro Area","Duluth, MN-WI Metro Area","Cincinnati-Middletown, OH-KY-IN Metro Area","Billings, MT Metro Area","Salem, OH Micro Area","Hermitage, PA Micro Area","Helena, MT Micro Area","Fort Wayne, IN Metro Area","Hickory-Lenoir-Morganton, NC Metro Area","Weirton-Steubenville, WV-OH Metro Area","Mansfield, OH Metro Area","Chillicothe, OH Micro Area","Midland, TX Metro Area","Owensboro, KY Metro Area","Columbus, IN Metro Area","Wichita, KS Metro Area","Lincoln, NE Metro Area","Quincy, IL-MO Micro Area","St. Joseph, MO-KS Metro Area","Sanford, NC Micro Area","Brainerd, MN Micro Area","Omaha-Council Bluffs, NE-IA Metro Area","Binghamton, NY Metro Area","Huntington-Ashland, WV-KY-OH Metro Area","Sioux City, IA-NE-SD Metro Area","Walla Walla, WA Metro Area","Rocky Mount, NC Metro Area","Warsaw, IN Micro Area","Pittsburgh, PA Metro Area","Chambersburg, PA Micro Area","Great Falls, MT Metro Area","Jamestown-Dunkirk-Fredonia, NY Micro Area","Adrian, MI Micro Area","Brigham City, UT-ID Micro Area","Clarksburg, WV Micro Area","Lynchburg, VA Metro Area","Searcy, AR Micro Area","Casper, WY Metro Area","Syracuse, NY Metro Area","Gadsden, AL Metro Area","Evansville, IN-KY Metro Area","Rapid City, SD Metro Area","Milwaukee-Waukesha-West Allis, WI Metro Area","Cumberland, MD-WV Metro Area","Huntsville, AL Metro Area","Topeka, KS Metro Area","Farmington, MO Micro Area","Fort Smith, AR-OK Metro Area","Morehead City, NC Micro Area","Russellville, AR Micro Area","Mankato-North Mankato, MN Metro Area","Cookeville, TN Micro Area","Akron, OH Metro Area","Shawnee, OK Micro Area","Toledo, OH Metro Area","Logan, UT-ID Metro Area","Erie, PA Metro Area","Lexington Park, MD Micro Area","Rockford, IL Metro Area","Monticello, NY Micro Area","Whitewater, WI Micro Area","Zanesville, OH Micro Area","Lansing-East Lansing, MI Metro Area","Utica-Rome, NY Metro Area","Waterloo-Cedar Falls, IA Metro Area","Rochester, MN Metro Area","Iowa City, IA Metro Area","Enid, OK Metro Area","Niles-Benton Harbor, MI Metro Area","Minneapolis-St. Paul-Bloomington, MN-WI Metro Area","Wichita Falls, TX Metro Area","Kingsport-Bristol-Bristol, TN-VA Metro Area","Lebanon, PA Metro Area","Buffalo-Niagara Falls, NY Metro Area","Plattsburgh, NY Micro Area","Harrisonburg, VA Metro Area","Hartford-West Hartford-East Hartford, CT Metro Area","Fort Payne, AL Micro Area","Concord, NH Micro Area","Anchorage, AK Metro Area","Ogden-Clearfield, UT Metro Area","Bowling Green, KY Metro Area","Warner Robins, GA Metro Area","Jackson, MI Metro Area","Cheyenne, WY Metro Area","Trenton-Ewing, NJ Metro Area","Muskogee, OK Micro Area","Cleveland, OH Metro Area","Somerset, KY Micro Area","Morgantown, WV Metro Area","Owosso, MI Micro Area","Dayton-Kettering, OH Metro Area","Youngstown-Warren-Boardman, OH-PA Metro Area","Joplin, MO Metro Area","Anniston-Oxford, AL Metro Area","Worcester, MA Metro Area","Wenatchee-East Wenatchee, WA Metro Area","Hagerstown-Martinsburg, MD-WV Metro Area","Hermiston-Pendleton, OR Micro Area","Provo-Orem, UT Metro Area","Portsmouth, OH Micro Area","Winston-Salem, NC Metro Area","Lebanon-Claremont, NH-VT Micro Area","Morristown, TN Metro Area","Flint, MI Metro Area","Kokomo, IN Metro Area","Aberdeen, WA Micro Area","Indianapolis-Carmel, IN Metro Area","Grand Rapids-Wyoming, MI Metro Area","Saginaw-Saginaw Township North, MI Metro Area","Altoona, PA Metro Area","Anderson Creek, NC Micro Area","Kansas City, MO-KS Metro Area","Rochester, NY Metro Area","Charleston, WV Metro Area","Harrisburg-Carlisle, PA Metro Area","Little Rock-North Little Rock-Conway, AR Metro Area","Lewiston, ID-WA Metro Area","Pocatello, ID Metro Area","Idaho Falls, ID Metro Area","Oxford, MS Micro Area","Springfield, MO Metro Area","Kennewick-Pasco-Richland, WA Metro Area","Columbia, MO Metro Area","New Iberia, LA Micro Area","Albany-Schenectady-Troy, NY Metro Area","Lewiston-Auburn, ME Metro Area","Louisville-Jefferson County, KY-IN Metro Area","Kalamazoo-Portage, MI Metro Area","Fayetteville-Springdale-Rogers, AR-MO Metro Area","Burlington, NC Metro Area","Winchester, VA-WV Metro Area","Lawrence, KS Metro Area","Battle Creek, MI Metro Area","Amarillo, TX Metro Area","Michigan City-La Porte, IN Metro Area","Cleveland, TN Metro Area","Seaford, DE Micro Area","Champaign-Urbana, IL Metro Area","Kankakee-Bradley, IL Metro Area","Kingston, NY Metro Area","Opelousas-Eunice, LA Micro Area","Muncie, IN Metro Area","Missoula, MT Metro Area","Greenwood, SC Micro Area","Santa Fe, NM Metro Area","Richmond, IN Micro Area","Chicago-Naperville-Joliet, IL-IN-WI Metro Area","Providence-New Bedford-Fall River, RI-MA Metro Area","Waterbury-Shelton, CT Metro Area","Lexington-Fayette, KY Metro Area","Beckley, WV Micro Area","Rome, GA Metro Area","Washington-Arlington-Alexandria, DC-VA-MD-WV Metro Area","South Bend-Mishawaka, IN-MI Metro Area","Elkhart-Goshen, IN Metro Area","Jonesboro, AR Metro Area","Manchester-Nashua, NH Metro Area","Centralia, WA Micro Area","Reading, PA Metro Area","Yakima, WA Metro Area","Orangeburg, SC Micro Area","Albany, GA Metro Area","Kenosha, WI Metro Area","Columbus, OH Metro Area","Lake Charles, LA Metro Area","Sevierville, TN Micro Area","Madison, WI Metro Area","Oklahoma City, OK Metro Area","Norwich-New London, CT Metro Area","Detroit-Warren-Livonia, MI Metro Area","Marion-Herrin, IL Micro Area","Greenfield Town, MA Micro Area","Montgomery, AL Metro Area","Augusta-Richmond County, GA-SC Metro Area","Muskegon-Norton Shores, MI Metro Area","Longview, TX Metro Area","Lake City, FL Micro Area","Rifle, CO Micro Area","Tulsa, OK Metro Area","Spartanburg, SC Metro Area","Johnson City, TN Metro Area","Laredo, TX Metro Area","Slidell-Mandeville-Covington, LA Metro Area","Augusta-Waterville, ME Micro Area","Tuscaloosa, AL Metro Area","Eagle Pass, TX Metro Area","Atlantic City-Hammonton, NJ Metro Area","Traverse City, MI Micro Area","Baltimore-Towson, MD Metro Area","Lafayette, LA Metro Area","Las Cruces, NM Metro Area","Roanoke, VA Metro Area","Dothan, AL Metro Area","Port Angeles, WA Micro Area","Longview, WA Metro Area","Lancaster, PA Metro Area","Allentown-Bethlehem-Easton, PA-NJ Metro Area","Victoria, TX Metro Area","Sumter, SC Metro Area","Birmingham-Hoover, AL Metro Area","Bangor, ME Metro Area","Forest City, NC Micro Area","Charlottesville, VA Metro Area","Raleigh-Cary, NC Metro Area","Philadelphia-Camden-Wilmington, PA-NJ-DE-MD Metro Area","Rexburg, ID Micro Area","Knoxville, TN Metro Area","Thomasville, GA Micro Area","Auburn-Opelika, AL Metro Area","Yuma, AZ Metro Area","Bridgeport-Stamford-Norwalk, CT Metro Area","Manhattan, KS Metro Area","Kiryas Joel-Poughkeepsie-Newburgh, NY Metro Area","Twin Falls, ID Micro Area","Burlington-South Burlington, VT Metro Area","Goldsboro, NC Metro Area","Greenville-Mauldin-Easley, SC Metro Area","Athens, TX Micro Area","Portland-South Portland-Biddeford, ME Metro Area","Farmington, NM Metro Area","Jackson, TN Metro Area","Stillwater, OK Micro Area","Springfield, MA Metro Area","Amherst Town-Northampton, MA Metro Area","Corbin, KY Micro Area","El Centro, CA Metro Area","Statesboro, GA Micro Area","Elmira, NY Metro Area","Baton Rouge, LA Metro Area","Roseburg, OR Micro Area","Nacogdoches, TX Micro Area","Macon, GA Metro Area","Show Low, AZ Micro Area","Staunton-Waynesboro, VA Micro Area","Kalispell, MT Micro Area","Pinehurst-Southern Pines, NC Micro Area","Meridian, MS Micro Area","Gulfport-Biloxi, MS Metro Area","Greeley, CO Metro Area","Brunswick, GA Metro Area","Terre Haute, IN Metro Area","Brownsville-Harlingen, TX Metro Area","State College, PA Metro Area","Ann Arbor, MI Metro Area","Salt Lake City, UT Metro Area","Lawton, OK Metro Area","Greenville, NC Metro Area","Columbia, SC Metro Area","Fairbanks, AK Metro Area","Greensboro-High Point, NC Metro Area","McAllen-Edinburg-Mission, TX Metro Area","Visalia-Porterville, CA Metro Area","Alexandria, LA Metro Area","Gainesville, GA Metro Area","Jackson, MS Metro Area","Beaumont-Port Arthur, TX Metro Area","Kapaa, HI Micro Area","Odessa, TX Metro Area","Yuba City, CA Metro Area","Pensacola-Ferry Pass-Brent, FL Metro Area","Spokane, WA Metro Area","Portland-Vancouver-Beaverton, OR-WA Metro Area","Daphne-Fairhope-Foley, AL Micro Area","Houma-Bayou Cane-Thibodaux, LA Metro Area","Richmond, VA Metro Area","Chattanooga, TN-GA Metro Area","New Bern, NC Micro Area","Seattle-Tacoma-Bellevue, WA Metro Area","Waco, TX Metro Area","Redding, CA Metro Area","Austin-Round Rock, TX Metro Area","Albuquerque, NM Metro Area","Barnstable Town, MA Metro Area","Pueblo, CO Metro Area","Lafayette-West Lafayette, IN Metro Area","Scranton--Wilkes-Barre, PA Metro Area","Tyler, TX Metro Area","Blacksburg-Christiansburg-Radford, VA Metro Area","Rio Grande City-Roma, TX Micro Area","Salisbury, MD Metro Area","Houston-Sugar Land-Baytown, TX Metro Area","Heber, UT Micro Area","Wildwood-The Villages, FL Metro Area","Hattiesburg, MS Metro Area","Oak Harbor, WA Micro Area","Boston-Cambridge-Quincy, MA-NH Metro Area","Hot Springs, AR Metro Area","San Jose-Sunnyvale-Santa Clara, CA Metro Area","Carson City, NV Metro Area","Tucson, AZ Metro Area","Dover, DE Metro Area","Hammond, LA Micro Area","Bremerton-Silverdale, WA Metro Area","Grants Pass, OR Micro Area","New Haven-Milford, CT Metro Area","Mount Vernon-Anacortes, WA Metro Area","Valdosta, GA Metro Area","Columbus, GA-AL Metro Area","Grand Junction, CO Metro Area","Danville, IL Metro Area","Boise City-Nampa, ID Metro Area","Myrtle Beach-North Myrtle Beach-Conway, SC Metro Area","Danville, VA Metro Area","San Antonio, TX Metro Area","Killeen-Temple-Fort Hood, TX Metro Area","Hanford-Corcoran, CA Metro Area","Shelton, WA Micro Area","Durham-Chapel Hill, NC Metro Area","Pikeville, KY Micro Area","Denver-Aurora-Broomfield, CO Metro Area","Vineland-Millville-Bridgeton, NJ Metro Area","Mobile, AL Metro Area","Palatka, FL Micro Area","Virginia Beach-Norfolk-Newport News, VA-NC Metro Area","Nashville-Davidson--Murfreesboro--Franklin, TN Metro Area","New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area","Charlotte-Gastonia-Concord, NC-SC Metro Area","Wilmington, NC Metro Area","Monroe, LA Metro Area","Pine Bluff, AR Metro Area","East Stroudsburg, PA Micro Area","Salem, OR Metro Area","Jacksonville, NC Metro Area","Bakersfield, CA Metro Area","Memphis, TN-MS-AR Metro Area","Shreveport-Bossier City, LA Metro Area","Corvallis, OR Metro Area","Granbury, TX Micro Area","San Francisco-Oakland-Fremont, CA Metro Area","Klamath Falls, OR Micro Area","Lufkin, TX Micro Area","Texarkana, TX-Texarkana, AR Metro Area","Bend, OR Metro Area","Athens-Clarke County, GA Metro Area","Dallas-Fort Worth-Arlington, TX Metro Area","Bloomington, IN Metro Area","LaGrange, GA Micro Area","Stockton, CA Metro Area","Asheville, NC Metro Area","Huntsville, TX Micro Area","Sacramento--Arden-Arcade--Roseville, CA Metro Area","Clarksville, TN-KY Metro Area","New Orleans-Metairie-Kenner, LA Metro Area","Colorado Springs, CO Metro Area","Sierra Vista-Douglas, AZ Micro Area","Alamogordo, NM Micro Area","Bluefield, WV-VA Micro Area","Olympia, WA Metro Area","El Paso, TX Metro Area","Florence, SC Metro Area","Gallup, NM Micro Area","Lumberton, NC Micro Area","Sherman-Denison, TX Metro Area","Albany-Lebanon, OR Micro Area","Lake Havasu City-Kingman, AZ Metro Area","Reno-Sparks, NV Metro Area","Modesto, CA Metro Area","Charleston-North Charleston-Summerville, SC Metro Area","Fort Collins-Loveland, CO Metro Area","Sebastian-Vero Beach, FL Metro Area","Tallahassee, FL Metro Area","Coeur d'Alene, ID Metro Area","Santa Cruz-Watsonville, CA Metro Area","Eugene-Springfield, OR Metro Area","Wilson, NC Micro Area","Corpus Christi, TX Metro Area","Hinesville-Fort Stewart, GA Metro Area","Bozeman, MT Micro Area","Atlanta-Sandy Springs-Marietta, GA Metro Area","Urban Honolulu, HI Metro Area","Savannah, GA Metro Area","Clovis, NM Micro Area","Medford, OR Metro Area","Fresno, CA Metro Area","Abilene, TX Metro Area","Fayetteville, NC Metro Area","San Angelo, TX Metro Area","Watertown-Fort Drum, NY Micro Area","Bellingham, WA Metro Area","Hilo, HI Micro Area","Boulder, CO Metro Area","Lubbock, TX Metro Area","Eureka-Arcata-Fortuna, CA Micro Area","Truckee-Grass Valley, CA Micro Area","Jacksonville, FL Metro Area","Santa Rosa-Petaluma, CA Metro Area","Phoenix-Mesa-Scottsdale, AZ Metro Area","Ithaca, NY Metro Area","Vallejo-Fairfield, CA Metro Area","Arecibo, PR Metro Area","Crestview-Fort Walton Beach-Destin, FL Metro Area","Hilton Head Island-Beaufort, SC Micro Area","Lakeland-Winter Haven, FL Metro Area","St. George, UT Metro Area","Palm Bay-Melbourne-Titusville, FL Metro Area","Sebring, FL Micro Area","Oxnard-Thousand Oaks-Ventura, CA Metro Area","Hobbs, NM Micro Area","Riverside-San Bernardino-Ontario, CA Metro Area","Homosassa Springs, FL Micro Area","San Juan-Caguas-Guaynabo, PR Metro Area","Punta Gorda, FL Metro Area","San Luis Obispo-Paso Robles, CA Metro Area","College Station-Bryan, TX Metro Area","Murrells Inlet, SC Micro Area","Ukiah, CA Micro Area","Napa, CA Metro Area","Prescott Valley-Prescott, AZ Metro Area","Panama City-Lynn Haven-Panama City Beach, FL Metro Area","Los Angeles-Long Beach-Anaheim, CA Metro Area","Santa Maria-Santa Barbara, CA Metro Area","Kahului-Wailuku, HI Micro Area","Flagstaff, AZ Metro Area","Las Vegas-Paradise, NV Metro Area","San Diego-Carlsbad-San Marcos, CA Metro Area","Gainesville, FL Metro Area","Mayag?ez, PR Metro Area","Guayama, PR Metro Area","Merced, CA Metro Area","Deltona-Daytona Beach-Ormond Beach, FL Metro Area","Naples-Marco Island, FL Metro Area","Chico, CA Metro Area","Salinas, CA Metro Area","Orlando-Kissimmee, FL Metro Area","Ocala, FL Metro Area","North Port-Bradenton-Sarasota, FL Metro Area","Key West, FL Micro Area","Tampa-St. Petersburg-Clearwater, FL Metro Area","Ponce, PR Metro Area","Port St. Lucie, FL Metro Area","Miami-Fort Lauderdale-Pompano Beach, FL Metro Area","Cape Coral-Fort Myers, FL Metro Area","Aguadilla-Isabela-San Sebasti?n, PR Metro Area","Clearlake, CA Micro Area"],[2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023],[1.6,3.5,5.3,5.8,5.9,5.9,6.7,7.3,7.9,8.1,8.4,8.699999999999999,9.1,9.199999999999999,9.300000000000001,9.5,9.699999999999999,10.2,10.4,10.5,10.5,10.5,10.7,10.8,10.9,11.3,11.9,12.2,12.2,12.5,12.5,12.7,12.8,12.8,12.9,13,13.1,13.1,13.2,13.3,13.3,13.3,13.3,13.5,13.5,13.6,13.6,13.7,13.9,14,14.1,14.3,14.4,14.5,14.7,15,15.1,15.3,15.3,15.3,15.4,15.5,15.5,15.6,15.8,15.8,15.8,16,16,16.2,16.2,16.5,16.5,16.7,16.8,16.9,17,17,17.2,17.3,17.3,17.3,17.4,17.5,17.5,17.5,17.6,17.6,17.6,17.7,17.7,17.8,17.8,17.9,17.9,18,18,18,18,18,18.1,18.1,18.2,18.4,18.4,18.5,18.5,18.6,18.7,18.7,18.8,18.8,18.8,18.9,19,19,19,19.1,19.1,19.2,19.2,19.2,19.2,19.2,19.3,19.3,19.3,19.3,19.4,19.7,19.7,19.8,19.8,19.9,19.9,19.9,20,20,20,20.1,20.1,20.1,20.2,20.2,20.4,20.5,20.5,20.5,20.6,20.6,20.7,20.8,20.9,21,21.1,21.2,21.2,21.4,21.4,21.5,21.6,21.6,21.7,21.9,22,22.1,22.2,22.2,22.4,22.5,22.7,22.7,22.7,22.8,22.8,22.9,23,23,23,23,23.1,23.1,23.2,23.2,23.3,23.4,23.4,23.6,23.7,23.8,23.8,23.8,23.9,23.9,24,24,24,24,24.1,24.1,24.2,24.2,24.2,24.2,24.2,24.3,24.3,24.4,24.4,24.6,24.6,24.6,24.6,24.7,24.9,24.9,24.9,24.9,24.9,25.1,25.2,25.3,25.3,25.4,25.4,25.4,25.4,25.5,25.5,25.5,25.7,25.7,25.8,25.8,25.9,26,26.1,26.2,26.2,26.3,26.3,26.3,26.4,26.4,26.4,26.4,26.5,26.6,26.7,26.9,26.9,26.9,27,27,27.1,27.1,27.3,27.4,27.5,27.6,27.7,27.8,27.8,28,28,28,28,28.1,28.1,28.4,28.4,28.5,28.5,28.5,28.5,28.6,28.6,28.7,28.8,28.8,28.8,28.9,28.9,28.9,29,29,29.1,29.3,29.3,29.3,29.3,29.4,29.4,29.4,29.5,29.6,29.7,29.8,29.8,29.9,30.1,30.1,30.1,30.2,30.2,30.2,30.2,30.3,30.3,30.3,30.3,30.3,30.4,30.4,30.5,30.5,30.5,30.8,31,31,31,31.1,31.2,31.2,31.4,31.5,31.6,31.7,31.8,31.8,32,32.1,32.2,32.2,32.3,32.4,32.4,32.7,32.8,32.8,32.9,32.9,33,33.1,33.1,33.2,33.3,33.4,33.4,33.4,33.4,33.5,33.7,33.8,33.8,33.8,33.9,34,34.2,34.3,34.4,34.4,34.5,34.7,34.8,34.9,34.9,34.9,35.2,35.3,35.6,35.7,35.7,35.7,35.8,35.9,36,36,36,36,36.2,36.2,36.2,36.3,36.3,36.4,36.4,36.5,36.6,36.7,36.9,37.1,37.1,37.1,37.2,37.2,37.3,37.4,37.4,37.4,37.4,37.6,37.6,37.7,37.7,37.8,37.9,38,38,38.1,38.2,38.3,38.3,38.4,38.7,38.7,38.8,38.9,38.9,39,39.3,39.3,39.3,39.4,39.4,39.5,39.5,39.6,39.7,39.8,39.9,40.1,40.2,40.2,40.3,40.3,40.3,40.3,40.5,40.5,40.5,40.6,40.7,40.8,40.9,41.2,41.2,41.3,41.4,41.7,41.7,41.8,41.8,41.8,41.8,42,42.1,42.4,42.6,42.9,43.4,43.5,43.5,43.5,43.6,43.8,43.8,43.9,44.2,44.8,44.8,44.8,44.8,44.9,45.1,45.2,45.5,45.7,46.2,46.3,46.5,47.3,47.6,47.8,47.9,49,49.2,49.4,49.6,49.6,49.7,49.7,49.9,50,50.1,50.5,50.5,50.6,50.7,50.8,51.1,51.3,51.6,51.9,52.6,52.9,53.5,53.7,54.5,54.6,55.1,55.4,56.1,56.5,56.6,57.1,57.4,57.6,58,60.2,60.4,61.4,61.5,62.6,63.4,66.40000000000001,68.8,68.90000000000001,71.8,72.90000000000001],["12.7%","13.2%","13.7%","13.8%","13.8%","13.8%","14.0%","14.2%","14.3%","14.4%","14.5%","14.6%","14.7%","14.7%","14.7%","14.8%","14.8%","15.0%","15.0%","15.0%","15.0%","15.0%","15.1%","15.1%","15.1%","15.2%","15.4%","15.5%","15.5%","15.6%","15.5%","15.6%","15.6%","15.6%","15.7%","15.7%","15.7%","15.7%","15.7%","15.8%","15.7%","15.7%","15.7%","15.8%","15.8%","15.8%","15.8%","15.9%","15.9%","15.9%","16.0%","16.0%","16.0%","16.1%","16.1%","16.2%","16.2%","16.3%","16.3%","16.3%","16.3%","16.3%","16.3%","16.3%","16.4%","16.4%","16.4%","16.4%","16.4%","16.5%","16.5%","16.6%","16.6%","16.6%","16.6%","16.7%","16.7%","16.7%","16.8%","16.8%","16.8%","16.8%","16.8%","16.8%","16.8%","16.8%","16.9%","16.9%","16.9%","16.9%","16.9%","16.9%","16.9%","16.9%","16.9%","17.0%","17.0%","17.0%","17.0%","17.0%","17.0%","17.0%","17.0%","17.1%","17.1%","17.1%","17.1%","17.1%","17.2%","17.1%","17.2%","17.2%","17.2%","17.2%","17.2%","17.2%","17.2%","17.3%","17.2%","17.3%","17.3%","17.3%","17.3%","17.3%","17.3%","17.3%","17.3%","17.3%","17.3%","17.4%","17.4%","17.4%","17.4%","17.5%","17.5%","17.5%","17.5%","17.5%","17.5%","17.5%","17.5%","17.5%","17.5%","17.5%","17.6%","17.6%","17.6%","17.6%","17.6%","17.6%","17.7%","17.7%","17.7%","17.8%","17.8%","17.8%","17.8%","17.9%","17.8%","17.9%","17.9%","17.9%","17.9%","18.0%","18.0%","18.0%","18.1%","18.1%","18.1%","18.1%","18.2%","18.2%","18.2%","18.2%","18.2%","18.3%","18.3%","18.3%","18.3%","18.3%","18.3%","18.3%","18.3%","18.3%","18.4%","18.4%","18.4%","18.4%","18.4%","18.5%","18.5%","18.5%","18.5%","18.5%","18.5%","18.5%","18.5%","18.5%","18.6%","18.6%","18.6%","18.6%","18.6%","18.6%","18.6%","18.6%","18.6%","18.6%","18.6%","18.7%","18.7%","18.7%","18.7%","18.7%","18.8%","18.8%","18.8%","18.8%","18.8%","18.8%","18.8%","18.9%","18.9%","18.9%","18.9%","18.9%","18.9%","18.9%","18.9%","18.9%","19.0%","19.0%","19.0%","19.0%","19.0%","19.0%","19.1%","19.1%","19.1%","19.1%","19.1%","19.1%","19.2%","19.2%","19.2%","19.1%","19.2%","19.2%","19.2%","19.3%","19.3%","19.3%","19.3%","19.3%","19.3%","19.3%","19.4%","19.4%","19.4%","19.4%","19.5%","19.5%","19.5%","19.6%","19.6%","19.6%","19.6%","19.6%","19.6%","19.7%","19.7%","19.7%","19.7%","19.7%","19.7%","19.7%","19.7%","19.7%","19.8%","19.8%","19.8%","19.8%","19.8%","19.8%","19.8%","19.8%","19.8%","19.9%","19.9%","19.9%","19.9%","19.9%","19.9%","19.9%","20.0%","20.0%","20.0%","20.0%","20.0%","20.0%","20.1%","20.1%","20.1%","20.1%","20.1%","20.1%","20.1%","20.2%","20.2%","20.2%","20.2%","20.1%","20.2%","20.2%","20.2%","20.2%","20.2%","20.3%","20.3%","20.3%","20.3%","20.4%","20.4%","20.4%","20.4%","20.5%","20.5%","20.5%","20.5%","20.5%","20.6%","20.6%","20.6%","20.6%","20.7%","20.7%","20.7%","20.8%","20.8%","20.8%","20.8%","20.8%","20.9%","20.9%","20.9%","20.9%","20.9%","21.0%","21.0%","21.0%","21.0%","21.0%","21.0%","21.1%","21.1%","21.1%","21.1%","21.1%","21.2%","21.2%","21.2%","21.2%","21.2%","21.3%","21.3%","21.3%","21.3%","21.3%","21.4%","21.5%","21.5%","21.6%","21.6%","21.5%","21.6%","21.6%","21.6%","21.6%","21.6%","21.6%","21.7%","21.7%","21.7%","21.7%","21.7%","21.7%","21.7%","21.8%","21.8%","21.8%","21.9%","21.9%","21.9%","21.9%","22.0%","21.9%","22.0%","22.0%","22.0%","22.0%","22.0%","22.0%","22.0%","22.1%","22.1%","22.1%","22.1%","22.2%","22.1%","22.2%","22.2%","22.2%","22.2%","22.3%","22.3%","22.3%","22.4%","22.4%","22.4%","22.4%","22.5%","22.5%","22.5%","22.5%","22.5%","22.5%","22.5%","22.6%","22.6%","22.6%","22.6%","22.7%","22.7%","22.7%","22.7%","22.7%","22.7%","22.7%","22.8%","22.8%","22.8%","22.8%","22.8%","22.9%","22.9%","23.0%","23.0%","23.0%","23.0%","23.1%","23.1%","23.1%","23.1%","23.1%","23.1%","23.2%","23.2%","23.3%","23.3%","23.4%","23.5%","23.6%","23.6%","23.6%","23.6%","23.7%","23.7%","23.7%","23.8%","23.9%","23.9%","23.9%","23.9%","23.9%","24.0%","24.0%","24.1%","24.2%","24.3%","24.3%","24.4%","24.6%","24.6%","24.7%","24.7%","25.0%","25.1%","25.1%","25.2%","25.2%","25.2%","25.2%","25.2%","25.3%","25.3%","25.4%","25.4%","25.4%","25.4%","25.5%","25.5%","25.6%","25.7%","25.7%","25.9%","26.0%","26.2%","26.2%","26.4%","26.4%","26.6%","26.7%","26.8%","26.9%","27.0%","27.1%","27.2%","27.2%","27.3%","27.9%","27.9%","28.2%","28.2%","28.5%","28.7%","29.5%","30.1%","30.1%","30.9%","31.2%"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>CBSA<\/th>\n      <th>Year<\/th>\n      <th>RBI (0–100)<\/th>\n      <th>Rent / Income<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"lengthMenu":[[10,25,50,100,-1],["10","25","50","100","All"]],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2]},{"name":"CBSA","targets":0},{"name":"Year","targets":1},{"name":"RBI (0–100)","targets":2},{"name":"Rent / Income","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="task-5-housing-growth" class="level2">
<h2 class="anchored" data-anchor-id="task-5-housing-growth">Task 5: Housing Growth</h2>
<div class="indent-block-tab">
<p>For this task we will be joining the Population and permits tables to create a suitable measure of housing growth. We will be creating two measures: instantaneous and rate-based. Once done so we will combine the two metrics to create a composite score. Then we will identify CBSA’s that do well and not well.</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RcppRoll)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmltools)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>permits_tbl <span class="ot">&lt;-</span> PERMITS <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">cbsa5 =</span> <span class="fu">as.integer</span>(CBSA),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>            year,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">permits =</span> new_housing_units_permitted)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>pop_tbl <span class="ot">&lt;-</span> POPULATION <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_cbsa5_census</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cbsa5, year, population)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Rolling 5-year population change</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>pop_5yr <span class="ot">&lt;-</span> pop_tbl <span class="sc">%&gt;%</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(cbsa5, year) <span class="sc">%&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cbsa5) <span class="sc">%&gt;%</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pop_lag5   =</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(population, <span class="dv">5</span>),</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">pop_delta5 =</span> population <span class="sc">-</span> pop_lag5) <span class="sc">%&gt;%</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only CBSA-years with both permits &amp; population</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>hg_base <span class="ot">&lt;-</span> permits_tbl <span class="sc">%&gt;%</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(pop_tbl,  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cbsa5"</span>,<span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pop_5yr <span class="sc">%&gt;%</span> <span class="fu">select</span>(cbsa5, year, pop_delta5), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cbsa5"</span>,<span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cbsa_names, <span class="at">by =</span> <span class="st">"cbsa5"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(cbsa5, year) <span class="sc">%&gt;%</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(cbsa5, year, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Define raw metrics + smooth with trailing 5-year averages</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>hg_metrics <span class="ot">&lt;-</span> hg_base <span class="sc">%&gt;%</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Instantaneous intensity: permits per 1,000 residents</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">inst_raw =</span> <span class="dv">1000</span> <span class="sc">*</span> permits <span class="sc">/</span> population,</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Growth-adjusted: permits per 1,000 new residents over prior 5 years</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate_raw =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(pop_delta5 <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1000</span> <span class="sc">*</span> permits <span class="sc">/</span> pop_delta5, <span class="cn">NA_real_</span>)</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cbsa5) <span class="sc">%&gt;%</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">inst_5yr =</span> RcppRoll<span class="sc">::</span><span class="fu">roll_meanr</span>(inst_raw, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">align =</span> <span class="st">"right"</span>),</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate_5yr =</span> RcppRoll<span class="sc">::</span><span class="fu">roll_meanr</span>(rate_raw, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">align =</span> <span class="st">"right"</span>)</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize each smoothed metric to 0–100 across ALL CBSA-years</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>minmax_100 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  fx <span class="ot">&lt;-</span> x[<span class="fu">is.finite</span>(x)]</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(fx) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">rep</span>(<span class="cn">NA_real_</span>, <span class="fu">length</span>(x)))</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(fx, <span class="at">na.rm =</span> <span class="cn">TRUE</span>); den <span class="ot">&lt;-</span> rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>]</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(den) <span class="sc">||</span> den <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="cn">NA_real_</span>, <span class="dv">50</span>))</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>  <span class="dv">100</span> <span class="sc">*</span> (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> den</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>hg_metrics <span class="ot">&lt;-</span> hg_metrics <span class="sc">%&gt;%</span></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">inst_100 =</span> <span class="fu">minmax_100</span>(inst_5yr),</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate_100 =</span> <span class="fu">minmax_100</span>(rate_5yr)</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the latest valid year for each metric (avoid empty tables)</span></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>latest_year_inst <span class="ot">&lt;-</span> <span class="fu">max</span>(hg_metrics<span class="sc">$</span>year[<span class="fu">is.finite</span>(hg_metrics<span class="sc">$</span>inst_100)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>latest_year_rate <span class="ot">&lt;-</span> <span class="fu">max</span>(hg_metrics<span class="sc">$</span>year[<span class="fu">is.finite</span>(hg_metrics<span class="sc">$</span>rate_100)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>latest_year_comp <span class="ot">&lt;-</span> <span class="fu">max</span>(hg_metrics<span class="sc">$</span>year[<span class="fu">is.finite</span>(hg_metrics<span class="sc">$</span>inst_100) <span class="sc">&amp;</span> <span class="fu">is.finite</span>(hg_metrics<span class="sc">$</span>rate_100)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Frames for latest valid snapshots</span></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>inst_latest <span class="ot">&lt;-</span> hg_metrics <span class="sc">%&gt;%</span></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> latest_year_inst, <span class="fu">is.finite</span>(inst_100)) <span class="sc">%&gt;%</span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(NAME, year, inst_5yr, inst_100)</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>rate_latest <span class="ot">&lt;-</span> hg_metrics <span class="sc">%&gt;%</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> latest_year_rate, <span class="fu">is.finite</span>(rate_100)) <span class="sc">%&gt;%</span></span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(NAME, year, rate_5yr, rate_100)</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>comp_latest <span class="ot">&lt;-</span> hg_metrics <span class="sc">%&gt;%</span></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> latest_year_comp, <span class="fu">is.finite</span>(inst_100), <span class="fu">is.finite</span>(rate_100)) <span class="sc">%&gt;%</span></span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">composite_100 =</span> <span class="fl">0.5</span> <span class="sc">*</span> inst_100 <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> rate_100) <span class="sc">%&gt;%</span></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(NAME, year, inst_100, rate_100, composite_100)</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a><span class="co"># How many rows to FLAG as Top/Bottom (tables still show ALL rows)</span></span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>top_n <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a><span class="co">#Instantaneous (ALL CBSAs; Top/Bottom flagged)</span></span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>inst_all <span class="ot">&lt;-</span> inst_latest <span class="sc">%&gt;%</span></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(inst_100)) <span class="sc">%&gt;%</span></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rank  =</span> <span class="fu">row_number</span>(),</span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">n</span>(),</span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">Group =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>      Rank <span class="sc">&lt;=</span> top_n <span class="sc">~</span> <span class="st">"Top"</span>,</span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>      Rank <span class="sc">&gt;</span>  Total <span class="sc">-</span> top_n <span class="sc">~</span> <span class="st">"Bottom"</span>,</span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Middle"</span></span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">Group =</span> <span class="fu">factor</span>(Group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Top"</span>,<span class="st">"Middle"</span>,<span class="st">"Bottom"</span>))</span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Group, Rank,</span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a>         <span class="at">CBSA =</span> NAME, <span class="at">Year =</span> year,</span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Inst (per 1k, 5-yr avg)</span><span class="st">`</span> <span class="ot">=</span> inst_5yr,</span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Index (0–100)</span><span class="st">`</span>          <span class="ot">=</span> inst_100) <span class="sc">%&gt;%</span></span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Inst (per 1k, 5-yr avg)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Inst (per 1k, 5-yr avg)</span><span class="st">`</span>, <span class="dv">2</span>),</span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Index (0–100)</span><span class="st">`</span>           <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Index (0–100)</span><span class="st">`</span>, <span class="dv">1</span>)</span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">h4</span>(<span class="fu">paste0</span>(<span class="st">"Instantaneous Housing Growth : All CBSAs (Top/Bottom flagged) : "</span>, <span class="fu">unique</span>(inst_all<span class="sc">$</span>Year)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<h4 class="anchored">Instantaneous Housing Growth : All CBSAs (Top/Bottom flagged) : 2023</h4>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  inst_all,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lengthMenu =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="fu">c</span>(<span class="st">"10"</span>, <span class="st">"25"</span>, <span class="st">"50"</span>, <span class="st">"100"</span>, <span class="st">"All"</span>)),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="dv">0</span>, <span class="st">'asc'</span>), <span class="fu">list</span>(<span class="dv">5</span>, <span class="st">'desc'</span>))  <span class="co"># Group then Index</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-2e7b9d149037f0bae49f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2e7b9d149037f0bae49f">{"x":{"filter":"none","vertical":false,"data":[["Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374],["Myrtle Beach-North Myrtle Beach-Conway, SC Metro Area","Punta Gorda, FL Metro Area","St. George, UT Metro Area","Austin-Round Rock, TX Metro Area","Salisbury, MD Metro Area","North Port-Bradenton-Sarasota, FL Metro Area","Daphne-Fairhope-Foley, AL Micro Area","Cape Coral-Fort Myers, FL Metro Area","Greeley, CO Metro Area","Lakeland-Winter Haven, FL Metro Area","Boise City-Nampa, ID Metro Area","Crestview-Fort Walton Beach-Destin, FL Metro Area","Hilton Head Island-Beaufort, SC Micro Area","Raleigh-Cary, NC Metro Area","Coeur d'Alene, ID Metro Area","Nashville-Davidson--Murfreesboro--Franklin, TN Metro Area","Naples-Marco Island, FL Metro Area","Sioux Falls, SD Metro Area","Port St. Lucie, FL Metro Area","Fayetteville-Springdale-Rogers, AR-MO Metro Area","Ocala, FL Metro Area","Jacksonville, FL Metro Area","Wilmington, NC Metro Area","Provo-Orem, UT Metro Area","Burlington, NC Metro Area","Panama City-Lynn Haven-Panama City Beach, FL Metro Area","Bend, OR Metro Area","Sherman-Denison, TX Metro Area","Orlando-Kissimmee, FL Metro Area","Charlotte-Gastonia-Concord, NC-SC Metro Area","Reno-Sparks, NV Metro Area","Auburn-Opelika, AL Metro Area","Charleston-North Charleston-Summerville, SC Metro Area","Durham-Chapel Hill, NC Metro Area","Clarksville, TN-KY Metro Area","Hammond, LA Micro Area","Homosassa Springs, FL Micro Area","Deltona-Daytona Beach-Ormond Beach, FL Metro Area","Houston-Sugar Land-Baytown, TX Metro Area","Colorado Springs, CO Metro Area","Huntsville, AL Metro Area","Dallas-Fort Worth-Arlington, TX Metro Area","Hinesville-Fort Stewart, GA Metro Area","Bowling Green, KY Metro Area","Sebastian-Vero Beach, FL Metro Area","Warner Robins, GA Metro Area","Rapid City, SD Metro Area","Logan, UT-ID Metro Area","Gainesville, GA Metro Area","Phoenix-Mesa-Scottsdale, AZ Metro Area","Idaho Falls, ID Metro Area","Greenville-Mauldin-Easley, SC Metro Area","Valdosta, GA Metro Area","Spartanburg, SC Metro Area","Fargo, ND-MN Metro Area","Missoula, MT Metro Area","Salt Lake City, UT Metro Area","Des Moines-West Des Moines, IA Metro Area","Lubbock, TX Metro Area","Asheville, NC Metro Area","Palm Bay-Melbourne-Titusville, FL Metro Area","Denver-Aurora-Broomfield, CO Metro Area","Fort Collins-Loveland, CO Metro Area","Savannah, GA Metro Area","Jonesboro, AR Metro Area","Tampa-St. Petersburg-Clearwater, FL Metro Area","Dover, DE Metro Area","Lake Havasu City-Kingman, AZ Metro Area","Madison, WI Metro Area","Brunswick, GA Metro Area","Tallahassee, FL Metro Area","Athens-Clarke County, GA Metro Area","Iowa City, IA Metro Area","Gainesville, FL Metro Area","Lafayette-West Lafayette, IN Metro Area","Lincoln, NE Metro Area","Killeen-Temple-Fort Hood, TX Metro Area","San Antonio, TX Metro Area","Wenatchee-East Wenatchee, WA Metro Area","Winchester, VA-WV Metro Area","Ogden-Clearfield, UT Metro Area","Odessa, TX Metro Area","Richmond, VA Metro Area","Bellingham, WA Metro Area","Kennewick-Pasco-Richland, WA Metro Area","Chico, CA Metro Area","McAllen-Edinburg-Mission, TX Metro Area","Jacksonville, NC Metro Area","Greenville, NC Metro Area","Columbia, SC Metro Area","College Station-Bryan, TX Metro Area","Grand Junction, CO Metro Area","Atlanta-Sandy Springs-Marietta, GA Metro Area","Seattle-Tacoma-Bellevue, WA Metro Area","Charlottesville, VA Metro Area","Gulfport-Biloxi, MS Metro Area","Winston-Salem, NC Metro Area","Pensacola-Ferry Pass-Brent, FL Metro Area","Cheyenne, WY Metro Area","Elizabethtown, KY Metro Area","Bremerton-Silverdale, WA Metro Area","Rochester, MN Metro Area","Cleveland, TN Metro Area","Eau Claire, WI Metro Area","Spokane, WA Metro Area","Flagstaff, AZ Metro Area","Las Vegas-Paradise, NV Metro Area","Minneapolis-St. Paul-Bloomington, MN-WI Metro Area","Hagerstown-Martinsburg, MD-WV Metro Area","Augusta-Richmond County, GA-SC Metro Area","Olympia, WA Metro Area","Portland-South Portland-Biddeford, ME Metro Area","Knoxville, TN Metro Area","Billings, MT Metro Area","Portland-Vancouver-Beaverton, OR-WA Metro Area","Lake Charles, LA Metro Area","Boulder, CO Metro Area","Ithaca, NY Metro Area","Laredo, TX Metro Area","Indianapolis-Carmel, IN Metro Area","Omaha-Council Bluffs, NE-IA Metro Area","Bloomington, IN Metro Area","Midland, TX Metro Area","Napa, CA Metro Area","Santa Rosa-Petaluma, CA Metro Area","Morristown, TN Metro Area","Hickory-Lenoir-Morganton, NC Metro Area","Chattanooga, TN-GA Metro Area","Lexington-Fayette, KY Metro Area","Yuma, AZ Metro Area","Columbus, OH Metro Area","Tucson, AZ Metro Area","Medford, OR Metro Area","Fort Wayne, IN Metro Area","Salem, OR Metro Area","Carson City, NV Metro Area","Sebring, FL Micro Area","Burlington-South Burlington, VT Metro Area","Oklahoma City, OK Metro Area","Las Cruces, NM Metro Area","Mount Vernon-Anacortes, WA Metro Area","Joplin, MO Metro Area","Lafayette, LA Metro Area","Brownsville-Harlingen, TX Metro Area","Mankato-North Mankato, MN Metro Area","Corpus Christi, TX Metro Area","Kansas City, MO-KS Metro Area","Corvallis, OR Metro Area","Pocatello, ID Metro Area","Tulsa, OK Metro Area","Waco, TX Metro Area","Louisville-Jefferson County, KY-IN Metro Area","Baton Rouge, LA Metro Area","Kahului-Wailuku, HI Micro Area","Tuscaloosa, AL Metro Area","Washington-Arlington-Alexandria, DC-VA-MD-WV Metro Area","Sacramento--Arden-Arcade--Roseville, CA Metro Area","Stockton, CA Metro Area","Bismarck, ND Metro Area","Fayetteville, NC Metro Area","Springfield, MO Metro Area","Champaign-Urbana, IL Metro Area","Santa Fe, NM Metro Area","Cape Girardeau-Jackson, MO-IL Metro Area","New Bern, NC Micro Area","Harrisonburg, VA Metro Area","Johnson City, TN Metro Area","Lawrence, KS Metro Area","Albany-Lebanon, OR Micro Area","Eugene-Springfield, OR Metro Area","Wichita, KS Metro Area","Little Rock-North Little Rock-Conway, AR Metro Area","Florence, SC Metro Area","Staunton-Waynesboro, VA Micro Area","Greensboro-High Point, NC Metro Area","Yuba City, CA Metro Area","La Crosse, WI-MN Metro Area","San Luis Obispo-Paso Robles, CA Metro Area","Ames, IA Metro Area","Appleton, WI Metro Area","Columbia, MO Metro Area","Green Bay, WI Metro Area","Walla Walla, WA Metro Area","San Jose-Sunnyvale-Santa Clara, CA Metro Area","Visalia-Porterville, CA Metro Area","Grand Rapids-Wyoming, MI Metro Area","Riverside-San Bernardino-Ontario, CA Metro Area","Virginia Beach-Norfolk-Newport News, VA-NC Metro Area","Beaumont-Port Arthur, TX Metro Area","St. Cloud, MN Metro Area","Miami-Fort Lauderdale-Pompano Beach, FL Metro Area","Sumter, SC Metro Area","Columbus, GA-AL Metro Area","Longview, WA Metro Area","Harrisburg-Carlisle, PA Metro Area","Goldsboro, NC Metro Area","Grand Island, NE Micro Area","Wausau, WI Metro Area","Fresno, CA Metro Area","Dalton, GA Metro Area","New Orleans-Metairie-Kenner, LA Metro Area","Evansville, IN-KY Metro Area","Memphis, TN-MS-AR Metro Area","Barnstable Town, MA Metro Area","Abilene, TX Metro Area","Hanford-Corcoran, CA Metro Area","Yakima, WA Metro Area","Tyler, TX Metro Area","Cedar Rapids, IA Metro Area","Birmingham-Hoover, AL Metro Area","Gettysburg, PA Micro Area","Sierra Vista-Douglas, AZ Micro Area","Sioux City, IA-NE-SD Metro Area","El Paso, TX Metro Area","New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area","Albuquerque, NM Metro Area","Grants Pass, OR Micro Area","Houma-Bayou Cane-Thibodaux, LA Metro Area","State College, PA Metro Area","Dothan, AL Metro Area","Dubuque, IA Metro Area","Blacksburg-Christiansburg-Radford, VA Metro Area","Oshkosh-Neenah, WI Metro Area","Rocky Mount, NC Metro Area","San Diego-Carlsbad-San Marcos, CA Metro Area","Pueblo, CO Metro Area","Great Falls, MT Metro Area","Philadelphia-Camden-Wilmington, PA-NJ-DE-MD Metro Area","Manchester-Nashua, NH Metro Area","Cincinnati-Middletown, OH-KY-IN Metro Area","Boston-Cambridge-Quincy, MA-NH Metro Area","Chambersburg, PA Micro Area","Lewiston-Auburn, ME Metro Area","Duluth, MN-WI Metro Area","Janesville, WI Metro Area","St. Louis, MO-IL Metro Area","Amarillo, TX Metro Area","San Francisco-Oakland-Fremont, CA Metro Area","Lynchburg, VA Metro Area","Baltimore-Towson, MD Metro Area","Atlantic City-Hammonton, NJ Metro Area","Vallejo-Fairfield, CA Metro Area","Bakersfield, CA Metro Area","York-Hanover, PA Metro Area","Shreveport-Bossier City, LA Metro Area","Rome, GA Metro Area","Casper, WY Metro Area","Merced, CA Metro Area","Fort Smith, AR-OK Metro Area","Ann Arbor, MI Metro Area","Kokomo, IN Metro Area","Lancaster, PA Metro Area","Owensboro, KY Metro Area","Albany-Schenectady-Troy, NY Metro Area","Monroe, LA Metro Area","Jackson, TN Metro Area","Lebanon, PA Metro Area","El Centro, CA Metro Area","San Angelo, TX Metro Area","Los Angeles-Long Beach-Anaheim, CA Metro Area","Kingsport-Bristol-Bristol, TN-VA Metro Area","Sheboygan, WI Metro Area","Columbus, IN Metro Area","Manhattan, KS Metro Area","Bangor, ME Metro Area","Jackson, MS Metro Area","Roanoke, VA Metro Area","Macon, GA Metro Area","Glens Falls, NY Metro Area","Lewiston, ID-WA Metro Area","Santa Maria-Santa Barbara, CA Metro Area","Grand Forks, ND-MN Metro Area","Pittsburgh, PA Metro Area","Anchorage, AK Metro Area","Montgomery, AL Metro Area","Urban Honolulu, HI Metro Area","Allentown-Bethlehem-Easton, PA-NJ Metro Area","Waterloo-Cedar Falls, IA Metro Area","Akron, OH Metro Area","Monroe, MI Metro Area","Kalamazoo-Portage, MI Metro Area","Alexandria, LA Metro Area","Fond du Lac, WI Metro Area","Muskegon-Norton Shores, MI Metro Area","Mobile, AL Metro Area","Redding, CA Metro Area","Toledo, OH Metro Area","Worcester, MA Metro Area","Kingston, NY Metro Area","Santa Cruz-Watsonville, CA Metro Area","Rochester, NY Metro Area","Niles-Benton Harbor, MI Metro Area","Milwaukee-Waukesha-West Allis, WI Metro Area","Florence-Muscle Shoals, AL Metro Area","Victoria, TX Metro Area","Topeka, KS Metro Area","Lansing-East Lansing, MI Metro Area","Chicago-Naperville-Joliet, IL-IN-WI Metro Area","New Haven-Milford, CT Metro Area","Norwich-New London, CT Metro Area","Wichita Falls, TX Metro Area","Elkhart-Goshen, IN Metro Area","Bloomsburg-Berwick, PA Micro Area","Detroit-Warren-Livonia, MI Metro Area","Salinas, CA Metro Area","South Bend-Mishawaka, IN-MI Metro Area","Canton-Massillon, OH Metro Area","Michigan City-La Porte, IN Metro Area","Bridgeport-Stamford-Norwalk, CT Metro Area","Elmira, NY Metro Area","Trenton-Ewing, NJ Metro Area","Davenport-Moline-Rock Island, IA-IL Metro Area","Racine, WI Metro Area","Albany, GA Metro Area","Binghamton, NY Metro Area","Longview, TX Metro Area","Pittsfield, MA Metro Area","Springfield, IL Metro Area","Midland, MI Micro Area","Bloomington, IL Metro Area","Oxnard-Thousand Oaks-Ventura, CA Metro Area","Jefferson City, MO Metro Area","Decatur, AL Metro Area","Hot Springs, AR Metro Area","East Stroudsburg, PA Micro Area","Watertown-Fort Drum, NY Micro Area","Hartford-West Hartford-East Hartford, CT Metro Area","Modesto, CA Metro Area","Lima, OH Metro Area","Buffalo-Niagara Falls, NY Metro Area","Jackson, MI Metro Area","Texarkana, TX-Texarkana, AR Metro Area","Providence-New Bedford-Fall River, RI-MA Metro Area","Flint, MI Metro Area","Gadsden, AL Metro Area","Saginaw-Saginaw Township North, MI Metro Area","Parkersburg-Marietta-Vienna, WV-OH Metro Area","Springfield, MA Metro Area","Reading, PA Metro Area","Utica-Rome, NY Metro Area","Springfield, OH Metro Area","Kankakee-Bradley, IL Metro Area","Scranton--Wilkes-Barre, PA Metro Area","Syracuse, NY Metro Area","Mansfield, OH Metro Area","St. Joseph, MO-KS Metro Area","Muncie, IN Metro Area","Altoona, PA Metro Area","Hattiesburg, MS Metro Area","Charleston, WV Metro Area","Erie, PA Metro Area","Farmington, NM Metro Area","Terre Haute, IN Metro Area","Rockford, IL Metro Area","Beckley, WV Micro Area","Vineland-Millville-Bridgeton, NJ Metro Area","Cumberland, MD-WV Metro Area","Peoria, IL Metro Area","Williamsport, PA Metro Area","Lawton, OK Metro Area","Huntington-Ashland, WV-KY-OH Metro Area","Pine Bluff, AR Metro Area","Youngstown-Warren-Boardman, OH-PA Metro Area","Bay City, MI Metro Area","Anniston-Oxford, AL Metro Area","Battle Creek, MI Metro Area","Enid, OK Metro Area","Morgantown, WV Metro Area","Johnstown, PA Metro Area","Wheeling, WV-OH Metro Area","Decatur, IL Metro Area","Fairbanks, AK Metro Area","Danville, IL Metro Area","Weirton-Steubenville, WV-OH Metro Area"],[2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023],[22.15,19.56,17.04,16.61,16.11,15.64,14.93,14.9,13.96,13.54,13.29,13.28,13.2,13,12.91,12.53,12.46,12.3,12.02,11.99,11.9,11.81,11.73,11.52,11.26,11.23,10.67,10.53,10.28,10.21,10.08,9.82,9.789999999999999,9.779999999999999,9.619999999999999,9.56,9.51,9.43,9.25,9.16,9.06,9.02,9,8.93,8.880000000000001,8.73,8.640000000000001,8.550000000000001,8.529999999999999,8.49,8.470000000000001,8.390000000000001,8.359999999999999,8.35,8.24,8.1,8.06,7.98,7.8,7.79,7.76,7.72,7.7,7.63,7.5,7.47,7.45,7.41,7.39,7.33,7.3,7.27,7.23,7.14,7.07,7.05,7.03,6.92,6.88,6.83,6.78,6.75,6.7,6.69,6.63,6.56,6.56,6.55,6.54,6.53,6.51,6.49,6.49,6.47,6.45,6.32,6.31,6.3,6.3,6.26,6.19,6.19,6.19,6.16,6.06,5.97,5.97,5.94,5.86,5.86,5.82,5.81,5.67,5.66,5.63,5.62,5.58,5.52,5.51,5.5,5.4,5.4,5.4,5.38,5.29,5.19,5.18,5.16,5.06,4.97,4.95,4.94,4.93,4.9,4.9,4.82,4.82,4.81,4.75,4.75,4.74,4.66,4.65,4.62,4.6,4.56,4.54,4.52,4.51,4.46,4.46,4.44,4.43,4.43,4.41,4.41,4.38,4.32,4.31,4.25,4.22,4.2,4.18,4.17,4.16,4.12,4.07,4.01,3.98,3.98,3.97,3.94,3.92,3.88,3.88,3.86,3.79,3.77,3.73,3.72,3.71,3.66,3.59,3.58,3.58,3.56,3.52,3.52,3.47,3.47,3.46,3.45,3.43,3.43,3.43,3.42,3.41,3.39,3.29,3.28,3.27,3.25,3.24,3.24,3.23,3.21,3.21,3.21,3.2,3.14,3.08,3.07,3.07,3.07,3.06,3.05,3.05,3.04,3.04,3.03,3.02,2.98,2.98,2.97,2.96,2.96,2.96,2.95,2.95,2.94,2.87,2.87,2.84,2.84,2.82,2.78,2.75,2.73,2.72,2.71,2.7,2.68,2.67,2.66,2.66,2.65,2.64,2.63,2.63,2.61,2.6,2.56,2.55,2.54,2.53,2.51,2.45,2.41,2.4,2.38,2.31,2.31,2.29,2.26,2.24,2.22,2.21,2.21,2.2,2.18,2.17,2.16,2.15,2.15,2.14,2.13,2.13,2.11,2.1,2.1,2.04,2.02,2.01,2,2,1.99,1.98,1.97,1.96,1.94,1.94,1.93,1.93,1.92,1.92,1.87,1.85,1.84,1.83,1.83,1.8,1.78,1.77,1.76,1.75,1.74,1.72,1.7,1.7,1.69,1.69,1.69,1.66,1.62,1.6,1.59,1.58,1.57,1.55,1.55,1.51,1.51,1.48,1.45,1.43,1.42,1.41,1.36,1.35,1.32,1.29,1.28,1.25,1.24,1.22,1.2,1.2,1.17,1.16,1.15,1.1,1.08,1.03,1.03,1.02,1,0.9,0.89,0.88,0.86,0.85,0.85,0.83,0.8100000000000001,0.8100000000000001,0.8100000000000001,0.79,0.79,0.78,0.76,0.76,0.7,0.68,0.67,0.67,0.66,0.52,0.5,0.49,0.36,0.31,0.31,0.25,0.23],[94.40000000000001,83.2,72.40000000000001,70.59999999999999,68.5,66.5,63.4,63.3,59.2,57.5,56.4,56.3,56,55.1,54.8,53.1,52.8,52.1,50.9,50.8,50.4,50,49.7,48.8,47.7,47.5,45.2,44.6,43.5,43.2,42.6,41.5,41.4,41.3,40.6,40.4,40.2,39.8,39.1,38.7,38.2,38.1,38,37.7,37.5,36.8,36.4,36.1,36,35.8,35.7,35.4,35.2,35.2,34.7,34.1,34,33.6,32.9,32.8,32.7,32.5,32.4,32.1,31.6,31.4,31.3,31.2,31.1,30.8,30.7,30.6,30.4,30,29.7,29.6,29.5,29.1,28.9,28.7,28.5,28.3,28.1,28.1,27.8,27.5,27.5,27.5,27.4,27.4,27.3,27.2,27.2,27.2,27.1,26.5,26.5,26.4,26.4,26.2,26,25.9,25.9,25.8,25.4,25,25,24.9,24.5,24.5,24.4,24.3,23.7,23.7,23.5,23.5,23.3,23.1,23,23,22.6,22.5,22.5,22.5,22.1,21.7,21.6,21.5,21.1,20.7,20.6,20.6,20.6,20.4,20.4,20.1,20.1,20,19.8,19.8,19.7,19.4,19.4,19.2,19.1,18.9,18.9,18.8,18.7,18.5,18.5,18.4,18.4,18.4,18.3,18.3,18.2,17.9,17.9,17.6,17.5,17.4,17.3,17.3,17.3,17.1,16.9,16.6,16.5,16.5,16.4,16.3,16.2,16,16,16,15.6,15.6,15.4,15.4,15.3,15.1,14.8,14.7,14.7,14.7,14.5,14.5,14.3,14.3,14.3,14.2,14.1,14.1,14.1,14,14,13.9,13.5,13.4,13.4,13.3,13.3,13.3,13.2,13.2,13.2,13.2,13.1,12.9,12.6,12.6,12.6,12.5,12.5,12.5,12.5,12.5,12.4,12.4,12.3,12.2,12.2,12.1,12.1,12.1,12.1,12.1,12.1,12,11.7,11.7,11.6,11.6,11.5,11.3,11.2,11.1,11.1,11,11,10.9,10.9,10.8,10.8,10.8,10.7,10.7,10.7,10.6,10.6,10.4,10.3,10.3,10.3,10.2,9.9,9.699999999999999,9.699999999999999,9.6,9.300000000000001,9.300000000000001,9.199999999999999,9.1,9,8.9,8.9,8.9,8.800000000000001,8.699999999999999,8.699999999999999,8.699999999999999,8.6,8.6,8.6,8.5,8.5,8.4,8.4,8.4,8.199999999999999,8.1,8,8,8,8,7.9,7.8,7.8,7.7,7.7,7.7,7.7,7.7,7.7,7.4,7.3,7.3,7.3,7.2,7.1,7,7,7,6.9,6.9,6.8,6.7,6.7,6.7,6.7,6.6,6.5,6.4,6.3,6.2,6.2,6.1,6,6,5.9,5.9,5.7,5.6,5.5,5.5,5.4,5.2,5.2,5.1,5,4.9,4.8,4.7,4.6,4.6,4.6,4.4,4.4,4.3,4.1,4.1,3.8,3.8,3.8,3.7,3.3,3.2,3.2,3.1,3.1,3,3,2.9,2.9,2.9,2.8,2.8,2.8,2.7,2.7,2.4,2.3,2.3,2.3,2.3,1.6,1.5,1.5,1,0.7,0.7,0.5,0.4]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Group<\/th>\n      <th>Rank<\/th>\n      <th>CBSA<\/th>\n      <th>Year<\/th>\n      <th>Inst (per 1k, 5-yr avg)<\/th>\n      <th>Index (0–100)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"lengthMenu":[[10,25,50,100,-1],["10","25","50","100","All"]],"scrollX":true,"order":[[0,"asc"],[5,"desc"]],"columnDefs":[{"className":"dt-right","targets":[1,3,4,5]},{"name":"Group","targets":0},{"name":"Rank","targets":1},{"name":"CBSA","targets":2},{"name":"Year","targets":3},{"name":"Inst (per 1k, 5-yr avg)","targets":4},{"name":"Index (0–100)","targets":5}],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rate-based (ALL CBSAs; Top/Bottom flagged)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>rate_all <span class="ot">&lt;-</span> rate_latest <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(rate_100)) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rank  =</span> <span class="fu">row_number</span>(),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">n</span>(),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Group =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>      Rank <span class="sc">&lt;=</span> top_n <span class="sc">~</span> <span class="st">"Top"</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>      Rank <span class="sc">&gt;</span>  Total <span class="sc">-</span> top_n <span class="sc">~</span> <span class="st">"Bottom"</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Middle"</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Group =</span> <span class="fu">factor</span>(Group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Top"</span>,<span class="st">"Middle"</span>,<span class="st">"Bottom"</span>))</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Group, Rank,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">CBSA =</span> NAME, <span class="at">Year =</span> year,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Rate (per 1k new res., 5-yr avg)</span><span class="st">`</span> <span class="ot">=</span> rate_5yr,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Index (0–100)</span><span class="st">`</span>                   <span class="ot">=</span> rate_100) <span class="sc">%&gt;%</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Rate (per 1k new res., 5-yr avg)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Rate (per 1k new res., 5-yr avg)</span><span class="st">`</span>, <span class="dv">2</span>),</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Index (0–100)</span><span class="st">`</span>                    <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Index (0–100)</span><span class="st">`</span>, <span class="dv">1</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">h4</span>(<span class="fu">paste0</span>(<span class="st">"Rate-based Housing Growth : All CBSAs (Top/Bottom flagged) : "</span>, <span class="fu">unique</span>(rate_all<span class="sc">$</span>Year)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<h4 class="anchored">Rate-based Housing Growth : All CBSAs (Top/Bottom flagged) : 2023</h4>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  rate_all,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lengthMenu =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="fu">c</span>(<span class="st">"10"</span>, <span class="st">"25"</span>, <span class="st">"50"</span>, <span class="st">"100"</span>, <span class="st">"All"</span>)),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="dv">0</span>, <span class="st">'asc'</span>), <span class="fu">list</span>(<span class="dv">5</span>, <span class="st">'desc'</span>))  <span class="co"># Group then Index</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f195947ae715be8c56f0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f195947ae715be8c56f0">{"x":{"filter":"none","vertical":false,"data":[["Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213],["Wausau, WI Metro Area","Albany-Schenectady-Troy, NY Metro Area","Louisville-Jefferson County, KY-IN Metro Area","Monroe, MI Metro Area","Brownsville-Harlingen, TX Metro Area","Sheboygan, WI Metro Area","Lewiston-Auburn, ME Metro Area","Redding, CA Metro Area","Jackson, MS Metro Area","Hickory-Lenoir-Morganton, NC Metro Area","Racine, WI Metro Area","Valdosta, GA Metro Area","Oshkosh-Neenah, WI Metro Area","Hanford-Corcoran, CA Metro Area","Miami-Fort Lauderdale-Pompano Beach, FL Metro Area","Baltimore-Towson, MD Metro Area","Dothan, AL Metro Area","Odessa, TX Metro Area","Tallahassee, FL Metro Area","Yuma, AZ Metro Area","Lynchburg, VA Metro Area","Albuquerque, NM Metro Area","Boulder, CO Metro Area","Detroit-Warren-Livonia, MI Metro Area","Dubuque, IA Metro Area","Cheyenne, WY Metro Area","Richmond, VA Metro Area","Janesville, WI Metro Area","Hammond, LA Micro Area","Flagstaff, AZ Metro Area","Lexington-Fayette, KY Metro Area","Philadelphia-Camden-Wilmington, PA-NJ-DE-MD Metro Area","San Angelo, TX Metro Area","Winston-Salem, NC Metro Area","Johnson City, TN Metro Area","Medford, OR Metro Area","Knoxville, TN Metro Area","Eau Claire, WI Metro Area","Hilton Head Island-Beaufort, SC Micro Area","Columbia, SC Metro Area","El Paso, TX Metro Area","Punta Gorda, FL Metro Area","Las Cruces, NM Metro Area","South Bend-Mishawaka, IN-MI Metro Area","Missoula, MT Metro Area","Jonesboro, AR Metro Area","Wilmington, NC Metro Area","Bismarck, ND Metro Area","Yakima, WA Metro Area","Burlington-South Burlington, VT Metro Area","Joplin, MO Metro Area","Lincoln, NE Metro Area","Chambersburg, PA Micro Area","Lafayette-West Lafayette, IN Metro Area","Baton Rouge, LA Metro Area","Gettysburg, PA Micro Area","Lubbock, TX Metro Area","Minneapolis-St. Paul-Bloomington, MN-WI Metro Area","Naples-Marco Island, FL Metro Area","Muskegon-Norton Shores, MI Metro Area","Fayetteville-Springdale-Rogers, AR-MO Metro Area","Little Rock-North Little Rock-Conway, AR Metro Area","McAllen-Edinburg-Mission, TX Metro Area","Denver-Aurora-Broomfield, CO Metro Area","Nashville-Davidson--Murfreesboro--Franklin, TN Metro Area","Washington-Arlington-Alexandria, DC-VA-MD-WV Metro Area","Santa Fe, NM Metro Area","Vallejo-Fairfield, CA Metro Area","North Port-Bradenton-Sarasota, FL Metro Area","Grand Junction, CO Metro Area","Portland-South Portland-Biddeford, ME Metro Area","Rochester, MN Metro Area","Augusta-Richmond County, GA-SC Metro Area","Lake Havasu City-Kingman, AZ Metro Area","Harrisonburg, VA Metro Area","Portland-Vancouver-Beaverton, OR-WA Metro Area","Madison, WI Metro Area","Visalia-Porterville, CA Metro Area","Chattanooga, TN-GA Metro Area","Cleveland, TN Metro Area","Dover, DE Metro Area","Mankato-North Mankato, MN Metro Area","Fond du Lac, WI Metro Area","Virginia Beach-Norfolk-Newport News, VA-NC Metro Area","Burlington, NC Metro Area","Crestview-Fort Walton Beach-Destin, FL Metro Area","Wenatchee-East Wenatchee, WA Metro Area","Iowa City, IA Metro Area","Cape Coral-Fort Myers, FL Metro Area","Salt Lake City, UT Metro Area","Carson City, NV Metro Area","Bremerton-Silverdale, WA Metro Area","Winchester, VA-WV Metro Area","Tucson, AZ Metro Area","Elkhart-Goshen, IN Metro Area","Colorado Springs, CO Metro Area","Bowling Green, KY Metro Area","Reno-Sparks, NV Metro Area","Greenville-Mauldin-Easley, SC Metro Area","Gainesville, GA Metro Area","Port St. Lucie, FL Metro Area","Ocala, FL Metro Area","Sioux Falls, SD Metro Area","Austin-Round Rock, TX Metro Area","Terre Haute, IN Metro Area","Fayetteville, NC Metro Area","Tulsa, OK Metro Area","Daphne-Fairhope-Foley, AL Micro Area","Boston-Cambridge-Quincy, MA-NH Metro Area","Houston-Sugar Land-Baytown, TX Metro Area","Raleigh-Cary, NC Metro Area","Green Bay, WI Metro Area","Greensboro-High Point, NC Metro Area","Charleston-North Charleston-Summerville, SC Metro Area","Phoenix-Mesa-Scottsdale, AZ Metro Area","Jacksonville, FL Metro Area","Savannah, GA Metro Area","Cedar Rapids, IA Metro Area","Athens-Clarke County, GA Metro Area","Eugene-Springfield, OR Metro Area","Rome, GA Metro Area","Riverside-San Bernardino-Ontario, CA Metro Area","Grants Pass, OR Micro Area","Salem, OR Metro Area","Sebring, FL Micro Area","Sherman-Denison, TX Metro Area","St. Cloud, MN Metro Area","Gulfport-Biloxi, MS Metro Area","Fargo, ND-MN Metro Area","St. George, UT Metro Area","Charlotte-Gastonia-Concord, NC-SC Metro Area","Omaha-Council Bluffs, NE-IA Metro Area","Auburn-Opelika, AL Metro Area","Staunton-Waynesboro, VA Micro Area","Dallas-Fort Worth-Arlington, TX Metro Area","Kansas City, MO-KS Metro Area","Deltona-Daytona Beach-Ormond Beach, FL Metro Area","Boise City-Nampa, ID Metro Area","Lewiston, ID-WA Metro Area","Homosassa Springs, FL Micro Area","Appleton, WI Metro Area","Seattle-Tacoma-Bellevue, WA Metro Area","Coeur d'Alene, ID Metro Area","Amarillo, TX Metro Area","Indianapolis-Carmel, IN Metro Area","Pueblo, CO Metro Area","Spokane, WA Metro Area","Palm Bay-Melbourne-Titusville, FL Metro Area","Durham-Chapel Hill, NC Metro Area","Lakeland-Winter Haven, FL Metro Area","York-Hanover, PA Metro Area","Bellingham, WA Metro Area","Huntsville, AL Metro Area","Pensacola-Ferry Pass-Brent, FL Metro Area","Fort Collins-Loveland, CO Metro Area","Sebastian-Vero Beach, FL Metro Area","Lancaster, PA Metro Area","Atlanta-Sandy Springs-Marietta, GA Metro Area","Tampa-St. Petersburg-Clearwater, FL Metro Area","Columbus, IN Metro Area","Greeley, CO Metro Area","Billings, MT Metro Area","Orlando-Kissimmee, FL Metro Area","Springfield, MO Metro Area","Sacramento--Arden-Arcade--Roseville, CA Metro Area","Logan, UT-ID Metro Area","Columbus, OH Metro Area","Bakersfield, CA Metro Area","Manchester-Nashua, NH Metro Area","Jacksonville, NC Metro Area","Modesto, CA Metro Area","Harrisburg-Carlisle, PA Metro Area","Oklahoma City, OK Metro Area","Provo-Orem, UT Metro Area","Yuba City, CA Metro Area","Cincinnati-Middletown, OH-KY-IN Metro Area","San Antonio, TX Metro Area","Fresno, CA Metro Area","Las Vegas-Paradise, NV Metro Area","Clarksville, TN-KY Metro Area","Midland, TX Metro Area","Kennewick-Pasco-Richland, WA Metro Area","Waco, TX Metro Area","Mount Vernon-Anacortes, WA Metro Area","Idaho Falls, ID Metro Area","College Station-Bryan, TX Metro Area","Allentown-Bethlehem-Easton, PA-NJ Metro Area","Killeen-Temple-Fort Hood, TX Metro Area","Olympia, WA Metro Area","Bend, OR Metro Area","Providence-New Bedford-Fall River, RI-MA Metro Area","Abilene, TX Metro Area","Grand Rapids-Wyoming, MI Metro Area","Des Moines-West Des Moines, IA Metro Area","Hagerstown-Martinsburg, MD-WV Metro Area","Corvallis, OR Metro Area","Hot Springs, AR Metro Area","Lebanon, PA Metro Area","Morristown, TN Metro Area","Stockton, CA Metro Area","Tuscaloosa, AL Metro Area","Albany-Lebanon, OR Micro Area","Pocatello, ID Metro Area","Longview, WA Metro Area","Gainesville, FL Metro Area","Hattiesburg, MS Metro Area","Reading, PA Metro Area","Tyler, TX Metro Area","Merced, CA Metro Area","Ames, IA Metro Area","Columbia, MO Metro Area","Longview, TX Metro Area","Morgantown, WV Metro Area"],[2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023],[5184.78,1907.39,1735.25,1684.63,939.98,898.75,894.4299999999999,631.4,624.9400000000001,452.07,371.74,359.63,346.02,330.19,320.78,288.01,283.23,281.21,276.71,244.33,242.07,240.54,225.55,219.62,219.37,212.72,194.66,194.24,193.5,189.08,188.55,182.15,181.67,181.63,181.5,181.04,176.51,175.23,174.31,172.74,171.91,171.33,169.98,168.44,165.83,165.63,164.63,162.54,161.68,161.01,157.48,154.98,154.62,153.04,153.02,153.01,152.59,150.49,148.47,147.63,147.25,146.53,146.34,144.54,144,143.23,142.74,142.14,141.72,138.3,138.06,137.11,136.19,135.6,135.51,135.24,134.05,133.91,133.66,132.44,132.16,130.67,129.86,129.54,129.4,129.15,128.59,127.99,127.59,127.11,126.55,126.27,125.65,124.44,123.22,123.17,121.6,120.2,119.51,119.29,119.12,118.11,117.56,117.52,117.04,116.27,115.46,114.57,114.52,112.95,112.7,112.36,111.46,111.39,110.91,110.13,109.69,109.22,108.93,107.88,107.21,107.01,106.96,105.7,105.43,104.71,104.65,104.51,104.22,103.92,103.9,103.62,103.31,103.19,103.12,102.51,101,100.54,99.18000000000001,98.69,98.58,98.52,98.48,98.13,98,97.91,97.14,97.06999999999999,96.54000000000001,96.3,96.23999999999999,95.45999999999999,95.31999999999999,94.2,93.75,93.73,93.72,93.45999999999999,93.38,91.98,91.95,90.61,90.34999999999999,89.77,89,88.26000000000001,87.51000000000001,86.44,86.16,85.90000000000001,84.59,83.43000000000001,83.18000000000001,83.09999999999999,81.5,80.77,79.87,79.68000000000001,79.64,79.56999999999999,78.62,77.64,77.13,77.06999999999999,76.37,74.61,73.48999999999999,72.72,72.38,71.84,71.16,70.14,70.06999999999999,68.13,67.94,64.28,64.05,63.55,63.08,62.01,60.21,60,54.93,53.42,52.67,52.3,51.55,50.18,50.02,32.47,29.68,23.37,20.24],[97,35.5,32.2,31.3,17.3,16.5,16.4,11.5,11.4,8.1,6.6,6.4,6.1,5.8,5.6,5,4.9,4.9,4.8,4.2,4.2,4.1,3.9,3.7,3.7,3.6,3.3,3.3,3.3,3.2,3.2,3,3,3,3,3,2.9,2.9,2.9,2.9,2.8,2.8,2.8,2.8,2.7,2.7,2.7,2.7,2.7,2.6,2.6,2.5,2.5,2.5,2.5,2.5,2.5,2.4,2.4,2.4,2.4,2.4,2.4,2.3,2.3,2.3,2.3,2.3,2.3,2.2,2.2,2.2,2.2,2.2,2.2,2.2,2.1,2.1,2.1,2.1,2.1,2.1,2.1,2.1,2.1,2,2,2,2,2,2,2,2,2,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1,1,1,1,1,1,0.9,0.9,0.9,0.9,0.8,0.8,0.8,0.8,0.8,0.8,0.7,0.7,0.6,0.6,0.6,0.6,0.6,0.6,0.2,0.2,0.1,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Group<\/th>\n      <th>Rank<\/th>\n      <th>CBSA<\/th>\n      <th>Year<\/th>\n      <th>Rate (per 1k new res., 5-yr avg)<\/th>\n      <th>Index (0–100)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"lengthMenu":[[10,25,50,100,-1],["10","25","50","100","All"]],"scrollX":true,"order":[[0,"asc"],[5,"desc"]],"columnDefs":[{"className":"dt-right","targets":[1,3,4,5]},{"name":"Group","targets":0},{"name":"Rank","targets":1},{"name":"CBSA","targets":2},{"name":"Year","targets":3},{"name":"Rate (per 1k new res., 5-yr avg)","targets":4},{"name":"Index (0–100)","targets":5}],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7) Composite (equal weights; ALL CBSAs; Top/Bottom flagged)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>comp_all <span class="ot">&lt;-</span> comp_latest <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(composite_100)) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rank  =</span> <span class="fu">row_number</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">n</span>(),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Group =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>      Rank <span class="sc">&lt;=</span> top_n <span class="sc">~</span> <span class="st">"Top"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>      Rank <span class="sc">&gt;</span>  Total <span class="sc">-</span> top_n <span class="sc">~</span> <span class="st">"Bottom"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Middle"</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Group =</span> <span class="fu">factor</span>(Group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Top"</span>,<span class="st">"Middle"</span>,<span class="st">"Bottom"</span>))</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Group, Rank,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">CBSA =</span> NAME, <span class="at">Year =</span> year,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Instantaneous (0–100)</span><span class="st">`</span> <span class="ot">=</span> inst_100,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Rate-based (0–100)</span><span class="st">`</span>    <span class="ot">=</span> rate_100,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Composite (0–100)</span><span class="st">`</span>     <span class="ot">=</span> composite_100) <span class="sc">%&gt;%</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Instantaneous (0–100)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Instantaneous (0–100)</span><span class="st">`</span>, <span class="dv">1</span>),</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Rate-based (0–100)</span><span class="st">`</span>    <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Rate-based (0–100)</span><span class="st">`</span>, <span class="dv">1</span>),</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Composite (0–100)</span><span class="st">`</span>     <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Composite (0–100)</span><span class="st">`</span>, <span class="dv">1</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">h4</span>(<span class="fu">paste0</span>(<span class="st">"Composite Housing Growth: All CBSAs (Top/Bottom flagged) : "</span>, <span class="fu">unique</span>(comp_all<span class="sc">$</span>Year)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<h4 class="anchored">Composite Housing Growth: All CBSAs (Top/Bottom flagged) : 2023</h4>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  comp_all,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lengthMenu =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="fu">c</span>(<span class="st">"10"</span>, <span class="st">"25"</span>, <span class="st">"50"</span>, <span class="st">"100"</span>, <span class="st">"All"</span>)),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="dv">0</span>, <span class="st">'asc'</span>), <span class="fu">list</span>(<span class="dv">6</span>, <span class="st">'desc'</span>))  <span class="co"># Group then Composite</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-19f26e44770a797140a5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-19f26e44770a797140a5">{"x":{"filter":"none","vertical":false,"data":[["Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Top","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Middle","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom","Bottom"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213],["Wausau, WI Metro Area","Punta Gorda, FL Metro Area","St. George, UT Metro Area","Austin-Round Rock, TX Metro Area","North Port-Bradenton-Sarasota, FL Metro Area","Cape Coral-Fort Myers, FL Metro Area","Daphne-Fairhope-Foley, AL Micro Area","Greeley, CO Metro Area","Lakeland-Winter Haven, FL Metro Area","Hilton Head Island-Beaufort, SC Micro Area","Crestview-Fort Walton Beach-Destin, FL Metro Area","Boise City-Nampa, ID Metro Area","Raleigh-Cary, NC Metro Area","Coeur d'Alene, ID Metro Area","Nashville-Davidson--Murfreesboro--Franklin, TN Metro Area","Naples-Marco Island, FL Metro Area","Sioux Falls, SD Metro Area","Fayetteville-Springdale-Rogers, AR-MO Metro Area","Port St. Lucie, FL Metro Area","Wilmington, NC Metro Area","Ocala, FL Metro Area","Jacksonville, FL Metro Area","Louisville-Jefferson County, KY-IN Metro Area","Provo-Orem, UT Metro Area","Burlington, NC Metro Area","Sherman-Denison, TX Metro Area","Bend, OR Metro Area","Albany-Schenectady-Troy, NY Metro Area","Orlando-Kissimmee, FL Metro Area","Charlotte-Gastonia-Concord, NC-SC Metro Area","Reno-Sparks, NV Metro Area","Hammond, LA Micro Area","Charleston-North Charleston-Summerville, SC Metro Area","Auburn-Opelika, AL Metro Area","Durham-Chapel Hill, NC Metro Area","Clarksville, TN-KY Metro Area","Homosassa Springs, FL Micro Area","Valdosta, GA Metro Area","Deltona-Daytona Beach-Ormond Beach, FL Metro Area","Houston-Sugar Land-Baytown, TX Metro Area","Colorado Springs, CO Metro Area","Monroe, MI Metro Area","Huntsville, AL Metro Area","Dallas-Fort Worth-Arlington, TX Metro Area","Bowling Green, KY Metro Area","Sebastian-Vero Beach, FL Metro Area","Gainesville, GA Metro Area","Phoenix-Mesa-Scottsdale, AZ Metro Area","Logan, UT-ID Metro Area","Greenville-Mauldin-Easley, SC Metro Area","Missoula, MT Metro Area","Idaho Falls, ID Metro Area","Brownsville-Harlingen, TX Metro Area","Fargo, ND-MN Metro Area","Salt Lake City, UT Metro Area","Tallahassee, FL Metro Area","Lubbock, TX Metro Area","Denver-Aurora-Broomfield, CO Metro Area","Des Moines-West Des Moines, IA Metro Area","Jonesboro, AR Metro Area","Palm Bay-Melbourne-Titusville, FL Metro Area","Savannah, GA Metro Area","Fort Collins-Loveland, CO Metro Area","Dover, DE Metro Area","Lake Havasu City-Kingman, AZ Metro Area","Odessa, TX Metro Area","Madison, WI Metro Area","Tampa-St. Petersburg-Clearwater, FL Metro Area","Iowa City, IA Metro Area","Athens-Clarke County, GA Metro Area","Lafayette-West Lafayette, IN Metro Area","Lincoln, NE Metro Area","Richmond, VA Metro Area","Wenatchee-East Wenatchee, WA Metro Area","Winchester, VA-WV Metro Area","Gainesville, FL Metro Area","Killeen-Temple-Fort Hood, TX Metro Area","Columbia, SC Metro Area","San Antonio, TX Metro Area","Cheyenne, WY Metro Area","McAllen-Edinburg-Mission, TX Metro Area","Hickory-Lenoir-Morganton, NC Metro Area","Bellingham, WA Metro Area","Winston-Salem, NC Metro Area","Grand Junction, CO Metro Area","Kennewick-Pasco-Richland, WA Metro Area","Eau Claire, WI Metro Area","Jacksonville, NC Metro Area","Seattle-Tacoma-Bellevue, WA Metro Area","Atlanta-Sandy Springs-Marietta, GA Metro Area","College Station-Bryan, TX Metro Area","Flagstaff, AZ Metro Area","Rochester, MN Metro Area","Gulfport-Biloxi, MS Metro Area","Cleveland, TN Metro Area","Lewiston-Auburn, ME Metro Area","Bremerton-Silverdale, WA Metro Area","Pensacola-Ferry Pass-Brent, FL Metro Area","Minneapolis-St. Paul-Bloomington, MN-WI Metro Area","Boulder, CO Metro Area","Spokane, WA Metro Area","Augusta-Richmond County, GA-SC Metro Area","Knoxville, TN Metro Area","Portland-South Portland-Biddeford, ME Metro Area","Las Vegas-Paradise, NV Metro Area","Sheboygan, WI Metro Area","Portland-Vancouver-Beaverton, OR-WA Metro Area","Hagerstown-Martinsburg, MD-WV Metro Area","Olympia, WA Metro Area","Billings, MT Metro Area","Yuma, AZ Metro Area","Indianapolis-Carmel, IN Metro Area","Lexington-Fayette, KY Metro Area","Omaha-Council Bluffs, NE-IA Metro Area","Chattanooga, TN-GA Metro Area","Midland, TX Metro Area","Medford, OR Metro Area","Burlington-South Burlington, VT Metro Area","Las Cruces, NM Metro Area","Tucson, AZ Metro Area","Morristown, TN Metro Area","Carson City, NV Metro Area","Salem, OR Metro Area","Joplin, MO Metro Area","Columbus, OH Metro Area","Sebring, FL Micro Area","Mankato-North Mankato, MN Metro Area","Oklahoma City, OK Metro Area","Baton Rouge, LA Metro Area","Mount Vernon-Anacortes, WA Metro Area","Washington-Arlington-Alexandria, DC-VA-MD-WV Metro Area","Bismarck, ND Metro Area","Kansas City, MO-KS Metro Area","Tulsa, OK Metro Area","Jackson, MS Metro Area","Miami-Fort Lauderdale-Pompano Beach, FL Metro Area","Johnson City, TN Metro Area","Corvallis, OR Metro Area","Santa Fe, NM Metro Area","Waco, TX Metro Area","Sacramento--Arden-Arcade--Roseville, CA Metro Area","Fayetteville, NC Metro Area","Redding, CA Metro Area","Pocatello, ID Metro Area","Harrisonburg, VA Metro Area","Tuscaloosa, AL Metro Area","Hanford-Corcoran, CA Metro Area","Springfield, MO Metro Area","Stockton, CA Metro Area","Little Rock-North Little Rock-Conway, AR Metro Area","Oshkosh-Neenah, WI Metro Area","Eugene-Springfield, OR Metro Area","Greensboro-High Point, NC Metro Area","Staunton-Waynesboro, VA Micro Area","Dothan, AL Metro Area","Albany-Lebanon, OR Micro Area","Yuba City, CA Metro Area","Visalia-Porterville, CA Metro Area","Appleton, WI Metro Area","Green Bay, WI Metro Area","Albuquerque, NM Metro Area","Virginia Beach-Norfolk-Newport News, VA-NC Metro Area","Riverside-San Bernardino-Ontario, CA Metro Area","Dubuque, IA Metro Area","Baltimore-Towson, MD Metro Area","St. Cloud, MN Metro Area","Yakima, WA Metro Area","Ames, IA Metro Area","Grand Rapids-Wyoming, MI Metro Area","Columbia, MO Metro Area","El Paso, TX Metro Area","Harrisburg-Carlisle, PA Metro Area","Lynchburg, VA Metro Area","Philadelphia-Camden-Wilmington, PA-NJ-DE-MD Metro Area","Gettysburg, PA Micro Area","Cedar Rapids, IA Metro Area","Janesville, WI Metro Area","Longview, WA Metro Area","Fresno, CA Metro Area","Chambersburg, PA Micro Area","Abilene, TX Metro Area","Grants Pass, OR Micro Area","Tyler, TX Metro Area","Pueblo, CO Metro Area","Boston-Cambridge-Quincy, MA-NH Metro Area","Manchester-Nashua, NH Metro Area","Vallejo-Fairfield, CA Metro Area","Racine, WI Metro Area","Cincinnati-Middletown, OH-KY-IN Metro Area","San Angelo, TX Metro Area","Amarillo, TX Metro Area","Rome, GA Metro Area","York-Hanover, PA Metro Area","Bakersfield, CA Metro Area","Lancaster, PA Metro Area","Merced, CA Metro Area","Lebanon, PA Metro Area","Detroit-Warren-Livonia, MI Metro Area","Columbus, IN Metro Area","Muskegon-Norton Shores, MI Metro Area","Lewiston, ID-WA Metro Area","Fond du Lac, WI Metro Area","South Bend-Mishawaka, IN-MI Metro Area","Allentown-Bethlehem-Easton, PA-NJ Metro Area","Elkhart-Goshen, IN Metro Area","Modesto, CA Metro Area","Hot Springs, AR Metro Area","Longview, TX Metro Area","Providence-New Bedford-Fall River, RI-MA Metro Area","Reading, PA Metro Area","Terre Haute, IN Metro Area","Hattiesburg, MS Metro Area","Morgantown, WV Metro Area"],[2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023],[13.9,83.2,72.40000000000001,70.59999999999999,66.5,63.3,63.4,59.2,57.5,56,56.3,56.4,55.1,54.8,53.1,52.8,52.1,50.8,50.9,49.7,50.4,50,18.4,48.8,47.7,44.6,45.2,10.3,43.5,43.2,42.6,40.4,41.4,41.5,41.3,40.6,40.2,35.2,39.8,39.1,38.7,8.4,38.2,38.1,37.7,37.5,36,35.8,36.1,35.4,34.1,35.7,19.2,34.7,34,30.7,32.9,32.5,33.6,31.6,32.7,32.1,32.4,31.3,31.2,28.3,31.1,31.4,30.4,30.6,29.7,29.6,28.1,28.9,28.7,30,29.5,27.4,29.1,26.4,27.5,21.6,28.1,26.5,27.2,27.8,25.8,27.5,27.2,27.2,27.3,25,25.9,26.5,25.9,11.6,26,26.4,24.9,23.3,25.4,24.5,23.7,24.3,25,9.300000000000001,23.5,24.5,24.4,23.7,20.7,23,21.1,22.6,21.5,22.5,20.6,20,19.8,20.6,21.7,20.1,20.4,19.4,20.6,20.1,19.1,19.8,18.4,19.7,18.3,17.9,18.9,18.5,8.9,14.3,16.9,18.8,17.3,18.5,18.2,17.6,8,18.7,17.1,18.3,13.2,17.5,17.9,16.3,12.2,16.5,16,16,12.4,16.5,16,14.7,15.4,15.1,12.5,14.5,14.5,12.3,11,14.3,13.2,15.4,14.7,15.3,12.5,14.1,11.1,12.1,12.6,13.1,11.5,14.1,13.5,11.7,13.2,12.5,13.2,12.1,11.7,12.1,10.9,6.5,12,9.699999999999999,11.2,10.8,10.8,10.9,10.4,10.7,9.9,7,9.199999999999999,8,8.699999999999999,8,6.9,8.5,7,5.2,5.6,6.2,4.8,4.4,3,3.2,1.5],[97,2.8,1.6,1.8,2.3,2,1.8,1.3,1.4,2.9,2,1.5,1.7,1.5,2.3,2.4,1.8,2.4,1.9,2.7,1.8,1.7,32.2,1.2,2.1,1.6,1,35.5,1.3,1.6,1.9,3.3,1.7,1.6,1.4,1.1,1.5,6.4,1.5,1.7,1.9,31.3,1.4,1.6,1.9,1.4,1.9,1.7,1.3,1.9,2.7,1.1,17.3,1.6,2,4.8,2.5,2.3,0.9,2.7,1.4,1.7,1.4,2.1,2.2,4.9,2.1,1.4,2,1.7,2.5,2.5,3.3,2,2,0.6,1,2.9,1.1,3.6,2.4,8.1,1.4,3,2.2,1.1,2.9,1.2,1.5,1.4,1,3.2,2.2,1.6,2.1,16.4,2,1.4,2.4,3.9,1.4,2.2,2.9,2.2,1.1,16.5,2.2,0.9,1,1.3,4.2,1.5,3.2,1.6,2.1,1.1,3,2.6,2.8,2,0.8,2,1.6,2.6,1.3,1.6,2.1,1.2,2.5,1.1,2.3,2.7,1.5,1.8,11.4,5.6,3,0.8,2.3,1.1,1.3,1.8,11.5,0.7,2.2,0.8,5.8,1.3,0.8,2.4,6.1,1.6,1.7,1.6,4.9,0.7,1.2,2.1,1.5,1.7,4.1,2.1,1.6,3.7,5,1.6,2.7,0.2,0.9,0.2,2.8,1.2,4.2,3,2.5,1.7,3.3,0.6,1.1,2.5,0.9,1.6,0.6,1.5,1.8,1.2,2.3,6.6,1.1,3,1.5,1.6,1.4,1.2,1.4,0.6,0.8,3.7,1.3,2.4,1.5,2.1,2.8,1,1.9,1.2,0.8,0.1,1,0.6,1.8,0.6,0],[55.5,43,37,36.2,34.4,32.6,32.6,30.3,29.4,29.4,29.2,28.9,28.4,28.1,27.7,27.6,27,26.6,26.4,26.2,26.1,25.9,25.3,25,24.9,23.1,23.1,22.9,22.4,22.4,22.3,21.8,21.5,21.5,21.4,20.9,20.8,20.8,20.7,20.4,20.3,19.8,19.8,19.8,19.8,19.4,18.9,18.8,18.7,18.6,18.4,18.4,18.3,18.2,18,17.8,17.7,17.4,17.3,17.2,17.1,16.9,16.9,16.7,16.7,16.6,16.6,16.4,16.2,16.1,16.1,16.1,15.7,15.5,15.3,15.3,15.3,15.1,15.1,15,14.9,14.9,14.8,14.8,14.7,14.4,14.4,14.4,14.3,14.3,14.2,14.1,14.1,14,14,14,14,13.9,13.7,13.6,13.4,13.4,13.3,13.3,13.1,12.9,12.9,12.7,12.7,12.5,12.5,12.2,12.1,12.1,11.8,11.8,11.8,11.3,11.3,11.3,11.2,11,11,11,10.9,10.8,10.6,10.5,10.4,10.4,10.3,10.3,10.2,10.2,10.1,10,9.9,9.800000000000001,9.800000000000001,9.800000000000001,9.699999999999999,9.699999999999999,9.699999999999999,9.699999999999999,9.6,9.5,9.5,9.4,9.4,9.300000000000001,9.1,9.1,8.9,8.800000000000001,8.699999999999999,8.6,8.6,8.4,8.4,8.4,8.300000000000001,8.300000000000001,8.1,8,8,7.9,7.9,7.8,7.8,7.7,7.7,7.6,7.6,7.6,7.6,7.4,7.4,7.4,7.3,7.1,7.1,7.1,6.9,6.8,6.7,6.7,6.6,6.6,6.6,6.4,6.3,6.2,6.1,6.1,5.9,5.6,5.4,5.4,5.3,5.2,5.1,5,4.8,4.8,4.5,3.2,3.2,3.1,2.9,2.5,2.4,1.9,0.8]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Group<\/th>\n      <th>Rank<\/th>\n      <th>CBSA<\/th>\n      <th>Year<\/th>\n      <th>Instantaneous (0–100)<\/th>\n      <th>Rate-based (0–100)<\/th>\n      <th>Composite (0–100)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"lengthMenu":[[10,25,50,100,-1],["10","25","50","100","All"]],"scrollX":true,"order":[[0,"asc"],[6,"desc"]],"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6]},{"name":"Group","targets":0},{"name":"Rank","targets":1},{"name":"CBSA","targets":2},{"name":"Year","targets":3},{"name":"Instantaneous (0–100)","targets":4},{"name":"Rate-based (0–100)","targets":5},{"name":"Composite (0–100)","targets":6}],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="task-6-visualization" class="level2">
<h2 class="anchored" data-anchor-id="task-6-visualization">Task 6: Visualization</h2>
<div class="indent-block-tab">
<p>Now we will be creating visualizations to investigate the relationships between our Rent Burden and Housing Growth metrics.</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>years_early <span class="ot">&lt;-</span> <span class="dv">2009</span><span class="sc">:</span><span class="dv">2012</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>years_late  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2019</span>,<span class="dv">2020</span>, <span class="dv">2021</span>, <span class="dv">2022</span>, <span class="dv">2023</span>)  </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># returns NA instead of NaN if all-missing</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>safe_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>); <span class="cf">if</span> (<span class="fu">is.nan</span>(m)) <span class="cn">NA_real_</span> <span class="cf">else</span> m }</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Early/late rent burden and change (late - early)</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>rbi_cbsa <span class="ot">&lt;-</span> rbi_tbl <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cbsa5, NAME, year, RBI_100) <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cbsa5, NAME) <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">early_rbi =</span> <span class="fu">safe_mean</span>(RBI_100[year <span class="sc">%in%</span> years_early]),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">late_rbi  =</span> <span class="fu">safe_mean</span>(RBI_100[year <span class="sc">%in%</span> years_late ]),</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups   =</span> <span class="st">"drop"</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">delta_rbi =</span> late_rbi <span class="sc">-</span> early_rbi)  <span class="co"># &lt;0 means burden fell (improved)</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Population change over study window</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>pop_bounds <span class="ot">&lt;-</span> POPULATION <span class="sc">%&gt;%</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_cbsa5_census</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cbsa5, year, population) <span class="sc">%&gt;%</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(cbsa5, year) <span class="sc">%&gt;%</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cbsa5) <span class="sc">%&gt;%</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_first =</span> population[<span class="fu">which.min</span>(year)],</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_last  =</span> population[<span class="fu">which.max</span>(year)],</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_delta =</span> pop_last <span class="sc">-</span> pop_first,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Average housing-growth composite (0–100) across period</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>composite_by_year <span class="ot">&lt;-</span> hg_metrics <span class="sc">%&gt;%</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">composite_100 =</span> <span class="fu">ifelse</span>(<span class="fu">is.finite</span>(inst_100) <span class="sc">&amp;</span> <span class="fu">is.finite</span>(rate_100),</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.5</span> <span class="sc">*</span> inst_100 <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> rate_100, <span class="cn">NA_real_</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cbsa5, NAME, year, composite_100)</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>hg_cbsa <span class="ot">&lt;-</span> composite_by_year <span class="sc">%&gt;%</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cbsa5, NAME) <span class="sc">%&gt;%</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">composite_avg =</span> <span class="fu">safe_mean</span>(composite_100), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge to single summary frame</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>yimby_summary <span class="ot">&lt;-</span> rbi_cbsa <span class="sc">%&gt;%</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(pop_bounds, <span class="at">by =</span> <span class="st">"cbsa5"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(hg_cbsa,   <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cbsa5"</span>,<span class="st">"NAME"</span>))</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Flag “YIMBY” metros (four rules)</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>early_high_cut <span class="ot">&lt;-</span> <span class="fu">quantile</span>(yimby_summary<span class="sc">$</span>early_rbi, <span class="at">probs =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)   <span class="co"># high early burdene</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>comp_mean      <span class="ot">&lt;-</span> <span class="fu">mean</span>(yimby_summary<span class="sc">$</span>composite_avg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)                <span class="co"># above-average housing growth</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>yimby_summary <span class="ot">&lt;-</span> yimby_summary <span class="sc">%&gt;%</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">improvement       =</span> <span class="sc">-</span>delta_rbi,                      <span class="co"># up is better</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">cond_high_early   =</span> early_rbi <span class="sc">&gt;=</span> early_high_cut,     <span class="co"># relatively high early burden</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">cond_burden_fell  =</span> <span class="fu">is.finite</span>(delta_rbi) <span class="sc">&amp;</span> delta_rbi <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">cond_pop_grew     =</span> <span class="fu">is.finite</span>(pop_delta)  <span class="sc">&amp;</span> pop_delta <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">cond_growth_above =</span> <span class="fu">is.finite</span>(composite_avg) <span class="sc">&amp;</span> composite_avg <span class="sc">&gt;=</span> comp_mean,</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">YIMBY_flag        =</span> cond_high_early <span class="sc">&amp;</span> cond_burden_fell <span class="sc">&amp;</span> cond_pop_grew <span class="sc">&amp;</span> cond_growth_above</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose a few labels </span></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>label_top_n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>yimby_labels <span class="ot">&lt;-</span> yimby_summary <span class="sc">%&gt;%</span></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(YIMBY_flag) <span class="sc">%&gt;%</span></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(composite_avg)) <span class="sc">%&gt;%</span></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> label_top_n)</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a><span class="co">#  Visual 1 — Early burden vs improvement</span></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># background: all CBSAs</span></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> yimby_summary,</span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> early_rbi, <span class="at">y =</span> improvement),</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"grey65"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">1.7</span>) <span class="sc">+</span></span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># highlight: YIMBY CBSAs</span></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(yimby_summary, YIMBY_flag),</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> early_rbi, <span class="at">y =</span> improvement),</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#E31A1C"</span>, <span class="at">alpha =</span> <span class="fl">0.95</span>, <span class="at">size =</span> <span class="fl">2.8</span>) <span class="sc">+</span></span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># label a handful of the strongest YIMBYs</span></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> yimby_labels,</span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> early_rbi, <span class="at">y =</span> improvement, <span class="at">label =</span> NAME),</span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>, <span class="at">seed =</span> <span class="dv">5</span>, <span class="at">max.overlaps =</span> <span class="dv">30</span>, <span class="at">color =</span> <span class="st">"#E31A1C"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"grey60"</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> early_high_cut, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">color =</span> <span class="st">"grey60"</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Early Rent Burden vs. Improvement"</span>,</span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Early Rent Burden (0–100)"</span>,</span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Improvement in Rent Burden"</span></span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual 2 — Housing growth vs improvement</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>r_hg <span class="ot">&lt;-</span> <span class="fu">with</span>(yimby_summary, <span class="fu">suppressWarnings</span>(<span class="fu">cor</span>(composite_avg, improvement, <span class="at">use =</span> <span class="st">"complete.obs"</span>)))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> yimby_summary,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> composite_avg, <span class="at">y =</span> improvement),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"grey65"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">1.7</span>) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(yimby_summary, YIMBY_flag),</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> composite_avg, <span class="at">y =</span> improvement),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#1E88E5"</span>, <span class="at">alpha =</span> <span class="fl">0.95</span>, <span class="at">size =</span> <span class="fl">2.8</span>) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> yimby_labels,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> composite_avg, <span class="at">y =</span> improvement, <span class="at">label =</span> NAME),</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>, <span class="at">seed =</span> <span class="dv">7</span>, <span class="at">max.overlaps =</span> <span class="dv">30</span>, <span class="at">color =</span> <span class="st">"#1E88E5"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> yimby_summary,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> composite_avg, <span class="at">y =</span> improvement),</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"grey35"</span>, <span class="at">linewidth =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Housing Growth vs. Rent Burden Improvement"</span>,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Trend line from all metros; correlation r = "</span>,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(<span class="fu">is.finite</span>(r_hg), <span class="fu">round</span>(r_hg, <span class="dv">2</span>), <span class="st">"NA"</span>)),</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Average Housing Growth Composite"</span>,</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Improvement in Rent Burden"</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="indent-block-tab">
<p>Areas like Myrtle Beach–Conway, Lakeland–Winter Haven, St.&nbsp;George, and Wilmington started with high rent burden, their burden fell, population grew, and housing growth was above average. On Plot 1 they sit to the right of the dotted line and above the dashed line, and on Plot 2 they cluster toward the upper-right, meaning more building lined up with improved affordability.</p>
</div>
</section>
<section id="task-7-policy-brief-its-our-homes-and-we-need-it-now" class="level2">
<h2 class="anchored" data-anchor-id="task-7-policy-brief-its-our-homes-and-we-need-it-now">Task 7: Policy Brief: <strong>It’s our homes and we need it now!</strong></h2>
<div class="indent-block-tab">
<p>Far too long there have been a lack of homes within the United States. We as the people need to do something about this and create legislation that will actually help create that housing for us. Who will take the stand and get done what is needed? A new bill must be proposed in order to address this issue.</p>
<p>For our policy brief we will be proposing <strong>“Its our homes and we need it now!”</strong> bill to congress. This bill will grant metros with funds where housing is permitted and built, especially where rent burdens are high. The purpose of this bill is to create incentive’s around housing being built in areas where rent burden is high. If metros can show they are building a significant amount of housing this bill will reward them with funds in which they can further re-invest into their metro area.</p>
<p>There are two sponsors for this bill. We have a sponsor from Charleston, SC and a co-sponsor from San Jose, CA. Charleston has been a YIMBY success in where it started out with high rent burden, they reduced it over time and gained above average housing growth. This is a literal success story which shows how investing in housing will cause high growth and low rent burden over time. Our co-sponsor from San Jose, CA can address how the area still have a high rent burden but a blow average housing growth. This clearly shows that they need this bill in order to create more housing growth.</p>
<p>Health Care staff and Construction workers not only build our city but also heal it. Health care workers are already in a high stress environment and do not need the burden of rent on top of that. This is a large occupation in metro areas and have stable employment in hospitals and clinics. If they were to experience a lower rent burden, then that means hospitals would be sufficiently staffed and there would be less turnover. This bill would also help construction workers because they build homes! The program would fund the jobs that these construction workers are at. It would create steady work for these unionized individuals for the years to come.</p>
<p>We are able to measure success by building metrics like rent burden index, or housing growth. Once these are built out you will need to combine them to develop a composite score. This score will be used to identify good YIMBY cities where rent burden is low and housing growth is high. So what are we waiting for! Lets pass this bill today! <strong>It’s our homes and we need it now!</strong></p>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/lencon279\.github\.io\/STA9750-2025-FALL\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>